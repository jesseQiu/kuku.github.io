<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Powershell Skill - Cease to struggle and you cease to live</title>
  <meta name="author" content="JesseChiu">
  
  <meta name="description" content="获取当前目录下指定文件，递归1Get-ChildItem *.c -Recurse | ForEach-Object &amp;#123;2    $file = $_3    $content = Get-Content -LiteralPath $file -Raw4&amp;#125;

JSON 相关操作1">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="Powershell Skill"/>
  <meta property="og:site_name" content="Cease to struggle and you cease to live"/>

  
    <meta property="og:image" content=""/>
  

  
    <link rel="alternative" href="/atom.xml" title="Cease to struggle and you cease to live" type="application/atom+xml">
  
  
    <link href="/favicon.ico" rel="icon">
  

  <!-- CSS -->
  <link rel="stylesheet" href="/css/themes/spacelab.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/font-awesome.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/responsive.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/highlight.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/google-fonts.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

  <script src="/js/jquery-2.0.3.min.js"></script>
  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>

  <!-- analytics -->
  



</head>


 <body>  
  <nav id="main-nav" class="navbar navbar-inverse navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
      <button type="button" class="navbar-header navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
	<span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
       <a class="navbar-brand" href="/">Cease to struggle and you cease to live</a>
      <div class="collapse navbar-collapse nav-menu">
		<ul class="nav navbar-nav">
		  
		  <li>
			<a href="/archives" title="All the articles.">
			  <i class="fa fa-archive"></i>Archives
			</a>
		  </li>
		  
		  <li>
			<a href="/categories" title="All the categories.">
			  <i class="fa fa-folder"></i>Categories
			</a>
		  </li>
		  
		  <li>
			<a href="/tags" title="All the tags.">
			  <i class="fa fa-tags"></i>Tags
			</a>
		  </li>
		  
		  <li>
			<a href="/about" title="About me.">
			  <i class="fa fa-user"></i>About
			</a>
		  </li>
		  
		  <li>
			<a href="/atom.xml" title="">
			  <i class="fa fa-rss"></i>Rss
			</a>
		  </li>
		  
		  <li>
			<a href="/sitemap.xml" title="">
			  <i class="fa fa-sitemap"></i>Sitemap
			</a>
		  </li>
		  
		</ul>
      </div>
    </div> <!-- container -->
</nav>
<div class="clearfix"></div>

  <div class="container">
  	<div class="content">
    	 


	
		<div class="page-header page-header-inverse ">		
			<h1 class="title title-inverse "> Powershell Skill</h1>
		</div>		
	



<!-- 不蒜子统计 -->

        <span id="busuanzi_container_page_pv" style='display:none'>
              <i class="icon-smile icon"></i> 本文总阅读量: <span id="busuanzi_value_page_pv"><i class="fa fa-spinner fa-spin"></i></span> 次
        </span>






<div class="row post">
	<!-- cols -->
	
	<div id="top_meta"></div>
	<div class="col-md-9">
	

	<!-- content -->
	<div class="mypage">		
	  		

	  <h3 id="获取当前目录下指定文件，递归"><a href="#获取当前目录下指定文件，递归" class="headerlink" title="获取当前目录下指定文件，递归"></a>获取当前目录下指定文件，递归</h3><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="built_in">Get-ChildItem</span> *.c -Recurse | <span class="built_in">ForEach-Object</span> &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">    <span class="variable">$file</span> = <span class="variable">$_</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">    <span class="variable">$content</span> = <span class="built_in">Get-Content</span> -LiteralPath <span class="variable">$file</span> -Raw</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<h3 id="JSON-相关操作"><a href="#JSON-相关操作" class="headerlink" title="JSON 相关操作"></a>JSON 相关操作</h3><h4 id="1-读写取-json-文件"><a href="#1-读写取-json-文件" class="headerlink" title="1. 读写取 json 文件"></a>1. 读写取 json 文件</h4><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">// 读取</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"><span class="variable">$numberToEnglish</span> = <span class="built_in">Get-Content</span> -Raw ./i18n/e8_sui_last_time.json -Encoding UTF8 | <span class="built_in">ConvertFrom-Json</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">// 写入</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line"><span class="variable">$formalKeyToEnglish</span> | <span class="built_in">ConvertTo-Json</span> | <span class="built_in">Out-File</span> .\i18n\en.json -Encoding utf8</span></pre></td></tr></table></figure>

<h4 id="2-使用-JSON-创建对象"><a href="#2-使用-JSON-创建对象" class="headerlink" title="2. 使用 JSON 创建对象"></a>2. 使用 JSON 创建对象</h4><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="variable">$json</span> = <span class="string">@"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"><span class="string">&#123;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"><span class="string">    "ServerName": "<span class="variable">$env:ComputerName</span>",</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line"><span class="string">    "UserName": "<span class="variable">$env:UserName</span>",</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line"><span class="string">    "BIOS": &#123;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line"><span class="string">         "Manufacturer" : "$((Get-WmiObject -Class Win32_BIOS).Manufacturer)",</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line"><span class="string">         "Version" : "$((Get-WmiObject -Class Win32_BIOS).Version)",</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line"><span class="string">         "Serial" : "$((Get-WmiObject -Class Win32_BIOS).SerialNumber)"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line"><span class="string">         &#125;,</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line"><span class="string">    "OS" : "$([Environment]::OSVersion.VersionString)"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line"><span class="string"> &#125;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line"><span class="string">"@</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line"> </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line">// json -&gt; obj</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line"><span class="variable">$jsonObj</span> = <span class="built_in">ConvertFrom-Json</span> -InputObject <span class="variable">$json</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">16</span></pre></td><td class="code"><pre><span class="line">// 可以使用对象方法读写属性</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">17</span></pre></td><td class="code"><pre><span class="line"><span class="variable">$jsonObj</span>.ServerName</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">18</span></pre></td><td class="code"><pre><span class="line"><span class="variable">$jsonObj</span>.BIOS.Version</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">19</span></pre></td><td class="code"><pre><span class="line"><span class="variable">$jsonObj</span>.OS</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">20</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">21</span></pre></td><td class="code"><pre><span class="line">// json obj -&gt; json string</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">22</span></pre></td><td class="code"><pre><span class="line"><span class="variable">$jsonString</span> = <span class="built_in">ConvertTo-Json</span> -InputObject <span class="variable">$templateObj</span></span></pre></td></tr></table></figure>
<ul>
<li><a href="http://www.pstips.net/use-json-to-create-objects.html" target="_blank" rel="noopener">Powershell 使用 JSON 创建对象</a></li>
</ul>
<h3 id="XML-相关操作"><a href="#XML-相关操作" class="headerlink" title="XML 相关操作"></a>XML 相关操作</h3><h4 id="1-基础操作"><a href="#1-基础操作" class="headerlink" title="1. 基础操作"></a>1. 基础操作</h4><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="variable">$xml</span> = <span class="string">@'</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"><span class="string">&lt;?xml version="1.0" standalone="yes"?&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"><span class="string">&lt;staff branch="Hanover" Type="sales"&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line"><span class="string">&lt;employee&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line"><span class="string">&lt;Name&gt;Tobias Weltner&lt;/Name&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line"><span class="string">&lt;function&gt;management&lt;/function&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line"><span class="string">&lt;age&gt;39&lt;/age&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line"><span class="string">&lt;/employee&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line"><span class="string">&lt;employee&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line"><span class="string">&lt;Name&gt;Cofi Heidecke&lt;/Name&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line"><span class="string">&lt;function&gt;security&lt;/function&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line"><span class="string">&lt;age&gt;4&lt;/age&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line"><span class="string">&lt;/employee&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line"><span class="string">&lt;/staff&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line"><span class="string">'@</span> | <span class="built_in">Out-File</span> employee.xml</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">16</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">17</span></pre></td><td class="code"><pre><span class="line">// xml string -&gt; xml 结构</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">18</span></pre></td><td class="code"><pre><span class="line"><span class="variable">$xmldata</span> = [xml]<span class="variable">$xml</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">19</span></pre></td><td class="code"><pre><span class="line">// 读取 xml 文件</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">20</span></pre></td><td class="code"><pre><span class="line"><span class="variable">$xmldata</span> = [xml](<span class="built_in">Get-Content</span> employee.xml)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">21</span></pre></td><td class="code"><pre><span class="line">// 保存文件</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">22</span></pre></td><td class="code"><pre><span class="line"><span class="variable">$xmldata</span>.Save(“<span class="variable">$env:temp</span>\updateddata.xml”)</span></pre></td></tr></table></figure>

<h4 id="2-代码示例"><a href="#2-代码示例" class="headerlink" title="2. 代码示例"></a>2. 代码示例</h4><ul>
<li><p>xml 文件</p>
<figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">&lt;template xmlns=<span class="string">"http://www.ingenico.com/ingestate/paramTemplate"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">    id=<span class="string">"xxx"</span> name=<span class="string">"xxx"</span> description=<span class="string">"xxx Parameters"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">    version=<span class="string">"00002"</span>&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">&lt;fields&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">        &lt;!-- TERMINAL CONFIGURATION --&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">        &lt;dataField id=<span class="string">"MinimumAmount"</span> name=<span class="string">"Minimum Amount"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">            access=<span class="string">"READWRITE"</span> type=<span class="string">"numeric"</span> minLength=<span class="string">"1"</span> maxLength=<span class="string">"12"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">            defaultValue=<span class="string">"1"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">        &lt;dataField id=<span class="string">"ReceiptHeaderLine1"</span> name=<span class="string">"Header Line 1"</span> access=<span class="string">"READWRITE"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">            type=<span class="string">"alphanumeric"</span> minLength=<span class="string">"0"</span> maxLength=<span class="string">"27"</span> defaultValue=<span class="string">""</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line">        &lt;dataField id=<span class="string">"ReceiptHeaderLine2"</span> name=<span class="string">"Header Line 2"</span> access=<span class="string">"READWRITE"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line">            type=<span class="string">"alphanumeric"</span> minLength=<span class="string">"0"</span> maxLength=<span class="string">"27"</span> defaultValue=<span class="string">""</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line">        &lt;dataField id=<span class="string">"ReceiptHeaderLine3"</span> name=<span class="string">"Header Line 3"</span> access=<span class="string">"READWRITE"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line">            type=<span class="string">"alphanumeric"</span> minLength=<span class="string">"0"</span> maxLength=<span class="string">"27"</span> defaultValue=<span class="string">""</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">16</span></pre></td><td class="code"><pre><span class="line">        &lt;dataField id=<span class="string">"ReceiptHeaderLine4"</span> name=<span class="string">"Header Line 4"</span> access=<span class="string">"READWRITE"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">17</span></pre></td><td class="code"><pre><span class="line">            type=<span class="string">"alphanumeric"</span> minLength=<span class="string">"0"</span> maxLength=<span class="string">"27"</span> defaultValue=<span class="string">""</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">18</span></pre></td><td class="code"><pre><span class="line">        &lt;dataField id=<span class="string">"ReceiptHeaderLine5"</span> name=<span class="string">"Header Line 5"</span> access=<span class="string">"READWRITE"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">19</span></pre></td><td class="code"><pre><span class="line">            type=<span class="string">"alphanumeric"</span> minLength=<span class="string">"0"</span> maxLength=<span class="string">"27"</span> defaultValue=<span class="string">""</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">20</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">21</span></pre></td><td class="code"><pre><span class="line">        </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">22</span></pre></td><td class="code"><pre><span class="line">        &lt;!-- choiceField id=<span class="string">"VoidPasswordLevel"</span> name=<span class="string">"Void Password Level"</span> type=<span class="string">"SINGLE"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">23</span></pre></td><td class="code"><pre><span class="line">            defaultValue=<span class="string">"2"</span> access=<span class="string">"READWRITE"</span>&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">24</span></pre></td><td class="code"><pre><span class="line">            &lt;choiceValue label=<span class="string">"Manager"</span> value=<span class="string">"1"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">25</span></pre></td><td class="code"><pre><span class="line">            &lt;choiceValue label=<span class="string">"Supervisor"</span> value=<span class="string">"2"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">26</span></pre></td><td class="code"><pre><span class="line">            &lt;choiceValue label=<span class="string">"Access Freely"</span> value=<span class="string">"3"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">27</span></pre></td><td class="code"><pre><span class="line">        &lt;/choiceField&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">28</span></pre></td><td class="code"><pre><span class="line">        &lt;choiceField id=<span class="string">"SettlementPasswordLevel"</span> name=<span class="string">"Settlement Password Level"</span> type=<span class="string">"SINGLE"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">29</span></pre></td><td class="code"><pre><span class="line">            defaultValue=<span class="string">"2"</span> access=<span class="string">"READWRITE"</span>&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">30</span></pre></td><td class="code"><pre><span class="line">            &lt;choiceValue label=<span class="string">"Manager"</span> value=<span class="string">"1"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">31</span></pre></td><td class="code"><pre><span class="line">            &lt;choiceValue label=<span class="string">"Supervisor"</span> value=<span class="string">"2"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">32</span></pre></td><td class="code"><pre><span class="line">            &lt;choiceValue label=<span class="string">"Access Freely"</span> value=<span class="string">"3"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">33</span></pre></td><td class="code"><pre><span class="line">        &lt;/choiceField&gt; --&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">34</span></pre></td><td class="code"><pre><span class="line">        </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">35</span></pre></td><td class="code"><pre><span class="line">        &lt;choiceField id=<span class="string">"SaleEnabled"</span> name=<span class="string">"Sale"</span> type=<span class="string">"SINGLE"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">36</span></pre></td><td class="code"><pre><span class="line">            defaultValue=<span class="string">"1"</span> access=<span class="string">"READWRITE"</span>&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">37</span></pre></td><td class="code"><pre><span class="line">            &lt;choiceValue label=<span class="string">"Disabled"</span> value=<span class="string">"0"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">38</span></pre></td><td class="code"><pre><span class="line">            &lt;choiceValue label=<span class="string">"Enabled"</span> value=<span class="string">"1"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">39</span></pre></td><td class="code"><pre><span class="line">            &lt;choiceValue label=<span class="string">"Enabled &amp;amp; Hide"</span> value=<span class="string">"2"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">40</span></pre></td><td class="code"><pre><span class="line">        &lt;/choiceField&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">41</span></pre></td><td class="code"><pre><span class="line">        &lt;choiceField id=<span class="string">"VoidEnabled"</span> name=<span class="string">"Void"</span> type=<span class="string">"SINGLE"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">42</span></pre></td><td class="code"><pre><span class="line">            defaultValue=<span class="string">"1"</span> access=<span class="string">"READWRITE"</span>&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">43</span></pre></td><td class="code"><pre><span class="line">            &lt;choiceValue label=<span class="string">"Disabled"</span> value=<span class="string">"0"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">44</span></pre></td><td class="code"><pre><span class="line">            &lt;choiceValue label=<span class="string">"Enabled"</span> value=<span class="string">"1"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">45</span></pre></td><td class="code"><pre><span class="line">            &lt;choiceValue label=<span class="string">"Enabled &amp;amp; Hide"</span> value=<span class="string">"2"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">46</span></pre></td><td class="code"><pre><span class="line">        &lt;/choiceField&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">47</span></pre></td><td class="code"><pre><span class="line">        &lt;choiceField id=<span class="string">"InstalmentSaleEnabled"</span> name=<span class="string">"Instalment Sale"</span> type=<span class="string">"SINGLE"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">48</span></pre></td><td class="code"><pre><span class="line">            defaultValue=<span class="string">"0"</span> access=<span class="string">"READWRITE"</span>&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">49</span></pre></td><td class="code"><pre><span class="line">            &lt;choiceValue label=<span class="string">"Disabled"</span> value=<span class="string">"0"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">50</span></pre></td><td class="code"><pre><span class="line">            &lt;choiceValue label=<span class="string">"Enabled"</span> value=<span class="string">"1"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">51</span></pre></td><td class="code"><pre><span class="line">        &lt;/choiceField&gt;      </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">52</span></pre></td><td class="code"><pre><span class="line">        &lt;choiceField id=<span class="string">"PreAuthEnabled"</span> name=<span class="string">"PreAuth"</span> type=<span class="string">"SINGLE"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">53</span></pre></td><td class="code"><pre><span class="line">            defaultValue=<span class="string">"0"</span> access=<span class="string">"READWRITE"</span>&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">54</span></pre></td><td class="code"><pre><span class="line">            &lt;choiceValue label=<span class="string">"Disabled"</span> value=<span class="string">"0"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">55</span></pre></td><td class="code"><pre><span class="line">            &lt;choiceValue label=<span class="string">"Enabled"</span> value=<span class="string">"1"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">56</span></pre></td><td class="code"><pre><span class="line">        &lt;/choiceField&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">57</span></pre></td><td class="code"><pre><span class="line">        &lt;!-- &lt;choiceField id=<span class="string">"PreAuthCompletionOnlineEnabled"</span> name=<span class="string">"PreAuth-Comp Online"</span> type=<span class="string">"SINGLE"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">58</span></pre></td><td class="code"><pre><span class="line">            defaultValue=<span class="string">"1"</span> access=<span class="string">"READWRITE"</span>&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">59</span></pre></td><td class="code"><pre><span class="line">            &lt;choiceValue label=<span class="string">"Disabled"</span> value=<span class="string">"0"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">60</span></pre></td><td class="code"><pre><span class="line">            &lt;choiceValue label=<span class="string">"Enabled"</span> value=<span class="string">"1"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">61</span></pre></td><td class="code"><pre><span class="line">        &lt;/choiceField&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">62</span></pre></td><td class="code"><pre><span class="line">        &lt;choiceField id=<span class="string">"PreAuthCompletionOfflineEnabled"</span> name=<span class="string">"PreAuth-Comp Offline"</span> type=<span class="string">"SINGLE"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">63</span></pre></td><td class="code"><pre><span class="line">            defaultValue=<span class="string">"1"</span> access=<span class="string">"READWRITE"</span>&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">64</span></pre></td><td class="code"><pre><span class="line">            &lt;choiceValue label=<span class="string">"Disabled"</span> value=<span class="string">"0"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">65</span></pre></td><td class="code"><pre><span class="line">            &lt;choiceValue label=<span class="string">"Enabled"</span> value=<span class="string">"1"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">66</span></pre></td><td class="code"><pre><span class="line">        &lt;/choiceField&gt; --&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">67</span></pre></td><td class="code"><pre><span class="line">        &lt;choiceField id=<span class="string">"OfflineSaleEnabled"</span> name=<span class="string">"Offline Sale"</span> type=<span class="string">"SINGLE"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">68</span></pre></td><td class="code"><pre><span class="line">            defaultValue=<span class="string">"0"</span> access=<span class="string">"READWRITE"</span>&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">69</span></pre></td><td class="code"><pre><span class="line">            &lt;choiceValue label=<span class="string">"Disabled"</span> value=<span class="string">"0"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">70</span></pre></td><td class="code"><pre><span class="line">            &lt;choiceValue label=<span class="string">"Enabled"</span> value=<span class="string">"1"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">71</span></pre></td><td class="code"><pre><span class="line">        &lt;/choiceField&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">72</span></pre></td><td class="code"><pre><span class="line">        &lt;choiceField id=<span class="string">"UPIPreAuthEnabled"</span> name=<span class="string">"UPI PreAuth"</span> type=<span class="string">"SINGLE"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">73</span></pre></td><td class="code"><pre><span class="line">            defaultValue=<span class="string">"1"</span> access=<span class="string">"READWRITE"</span>&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">74</span></pre></td><td class="code"><pre><span class="line">            &lt;choiceValue label=<span class="string">"Disabled"</span> value=<span class="string">"0"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">75</span></pre></td><td class="code"><pre><span class="line">            &lt;choiceValue label=<span class="string">"Enabled"</span> value=<span class="string">"1"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">76</span></pre></td><td class="code"><pre><span class="line">        &lt;/choiceField&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">77</span></pre></td><td class="code"><pre><span class="line">        &lt;choiceField id=<span class="string">"RefundEnabled"</span> name=<span class="string">"Refund"</span> type=<span class="string">"SINGLE"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">78</span></pre></td><td class="code"><pre><span class="line">            defaultValue=<span class="string">"0"</span> access=<span class="string">"READWRITE"</span>&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">79</span></pre></td><td class="code"><pre><span class="line">            &lt;choiceValue label=<span class="string">"Disabled"</span> value=<span class="string">"0"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">80</span></pre></td><td class="code"><pre><span class="line">            &lt;choiceValue label=<span class="string">"Enabled"</span> value=<span class="string">"1"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">81</span></pre></td><td class="code"><pre><span class="line">        &lt;/choiceField&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">82</span></pre></td><td class="code"><pre><span class="line">        &lt;choiceField id=<span class="string">"TxCashAdvanceEnabled"</span> name=<span class="string">"Cash Advance"</span> type=<span class="string">"SINGLE"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">83</span></pre></td><td class="code"><pre><span class="line">            defaultValue=<span class="string">"0"</span> access=<span class="string">"READWRITE"</span>&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">84</span></pre></td><td class="code"><pre><span class="line">            &lt;choiceValue label=<span class="string">"Disabled"</span> value=<span class="string">"0"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">85</span></pre></td><td class="code"><pre><span class="line">            &lt;choiceValue label=<span class="string">"Enabled"</span> value=<span class="string">"1"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">86</span></pre></td><td class="code"><pre><span class="line">        &lt;/choiceField&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">87</span></pre></td><td class="code"><pre><span class="line">        &lt;choiceField id=<span class="string">"TxSaleWithCashEnabled"</span> name=<span class="string">"Sale + Cash"</span> type=<span class="string">"SINGLE"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">88</span></pre></td><td class="code"><pre><span class="line">            defaultValue=<span class="string">"0"</span> access=<span class="string">"READWRITE"</span>&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">89</span></pre></td><td class="code"><pre><span class="line">            &lt;choiceValue label=<span class="string">"Disabled"</span> value=<span class="string">"0"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">90</span></pre></td><td class="code"><pre><span class="line">            &lt;choiceValue label=<span class="string">"Enabled"</span> value=<span class="string">"1"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">91</span></pre></td><td class="code"><pre><span class="line">        &lt;/choiceField&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">92</span></pre></td><td class="code"><pre><span class="line">        &lt;choiceField id=<span class="string">"DebitPriority"</span> name=<span class="string">"MyDebit/Scheme Priority"</span> type=<span class="string">"SINGLE"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">93</span></pre></td><td class="code"><pre><span class="line">            defaultValue=<span class="string">"1"</span> access=<span class="string">"READWRITE"</span>&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">94</span></pre></td><td class="code"><pre><span class="line">            &lt;choiceValue label=<span class="string">"Opt-In"</span> value=<span class="string">"1"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">95</span></pre></td><td class="code"><pre><span class="line">            &lt;choiceValue label=<span class="string">"Opt-Out"</span> value=<span class="string">"0"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">96</span></pre></td><td class="code"><pre><span class="line">        &lt;/choiceField&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">97</span></pre></td><td class="code"><pre><span class="line">        &lt;!-- &lt;choiceField id=<span class="string">"VoidPreAuthEnabled"</span> name=<span class="string">"Void PreAuth"</span> type=<span class="string">"SINGLE"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">98</span></pre></td><td class="code"><pre><span class="line">            defaultValue=<span class="string">"1"</span> access=<span class="string">"READWRITE"</span>&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">99</span></pre></td><td class="code"><pre><span class="line">            &lt;choiceValue label=<span class="string">"Disabled"</span> value=<span class="string">"0"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">100</span></pre></td><td class="code"><pre><span class="line">            &lt;choiceValue label=<span class="string">"Enabled"</span> value=<span class="string">"1"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">101</span></pre></td><td class="code"><pre><span class="line">        &lt;/choiceField&gt; --&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">102</span></pre></td><td class="code"><pre><span class="line">        &lt;choiceField id=<span class="string">"SaleContactlessEnabled"</span> name=<span class="string">"Contactless Sale"</span> type=<span class="string">"SINGLE"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">103</span></pre></td><td class="code"><pre><span class="line">            defaultValue=<span class="string">"0"</span> access=<span class="string">"READWRITE"</span>&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">104</span></pre></td><td class="code"><pre><span class="line">            &lt;choiceValue label=<span class="string">"Disabled"</span> value=<span class="string">"0"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">105</span></pre></td><td class="code"><pre><span class="line">            &lt;choiceValue label=<span class="string">"Enabled"</span> value=<span class="string">"1"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">106</span></pre></td><td class="code"><pre><span class="line">        &lt;/choiceField&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">107</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">108</span></pre></td><td class="code"><pre><span class="line">        &lt;!-- EMV Tags --&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">109</span></pre></td><td class="code"><pre><span class="line">        &lt;dataField id=<span class="string">"TermCapability"</span> name=<span class="string">"Terminal Capability"</span> access=<span class="string">"READWRITE"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">110</span></pre></td><td class="code"><pre><span class="line">            type=<span class="string">"alphanumeric"</span> minLength=<span class="string">"6"</span> maxLength=<span class="string">"6"</span> defaultValue=<span class="string">"E0F0C8"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">111</span></pre></td><td class="code"><pre><span class="line">        &lt;dataField id=<span class="string">"AdditionTermCapability"</span> name=<span class="string">"Additional Terminal Capability"</span> access=<span class="string">"READWRITE"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">112</span></pre></td><td class="code"><pre><span class="line">            type=<span class="string">"alphanumeric"</span> minLength=<span class="string">"10"</span> maxLength=<span class="string">"10"</span> defaultValue=<span class="string">"F000F0A001"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">113</span></pre></td><td class="code"><pre><span class="line">        &lt;dataField id=<span class="string">"TermType"</span> name=<span class="string">"Terminal Type"</span> access=<span class="string">"READWRITE"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">114</span></pre></td><td class="code"><pre><span class="line">            type=<span class="string">"alphanumeric"</span> minLength=<span class="string">"2"</span> maxLength=<span class="string">"2"</span> defaultValue=<span class="string">"22"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">115</span></pre></td><td class="code"><pre><span class="line">        &lt;dataField id=<span class="string">"TermCountryCode"</span> name=<span class="string">"Terminal Country Code"</span> access=<span class="string">"READWRITE"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">116</span></pre></td><td class="code"><pre><span class="line">            type=<span class="string">"numeric"</span> minLength=<span class="string">"3"</span> maxLength=<span class="string">"3"</span> defaultValue=<span class="string">"458"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">117</span></pre></td><td class="code"><pre><span class="line">        &lt;dataField id=<span class="string">"TerminalBaseCurrencyCode"</span> name=<span class="string">"Terminal Base Currency Code"</span> access=<span class="string">"READWRITE"</span> </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">118</span></pre></td><td class="code"><pre><span class="line">            type=<span class="string">"numeric"</span> minLength=<span class="string">"3"</span> maxLength=<span class="string">"3"</span> defaultValue=<span class="string">"458"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">119</span></pre></td><td class="code"><pre><span class="line">        </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">120</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">121</span></pre></td><td class="code"><pre><span class="line">        &lt;!-- QR Settings --&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">122</span></pre></td><td class="code"><pre><span class="line">        &lt;dataField id=<span class="string">"QROptInOption"</span> name=<span class="string">"QR OptIn Option"</span> access=<span class="string">"READWRITE"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">123</span></pre></td><td class="code"><pre><span class="line">            type=<span class="string">"alphanumeric"</span> minLength=<span class="string">"0"</span> maxLength=<span class="string">"1"</span> defaultValue=<span class="string">"Y"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">124</span></pre></td><td class="code"><pre><span class="line">        &lt;dataField id=<span class="string">"QRPaymentURL"</span> name=<span class="string">"QR Payment URL"</span> access=<span class="string">"READWRITE"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">125</span></pre></td><td class="code"><pre><span class="line">            type=<span class="string">"alphanumeric"</span> minLength=<span class="string">"0"</span> maxLength=<span class="string">"99"</span> defaultValue=<span class="string">""</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">126</span></pre></td><td class="code"><pre><span class="line">        &lt;dataField id=<span class="string">"QRPaymentInqURL"</span> name=<span class="string">"QR Payment Inq URL"</span> access=<span class="string">"READWRITE"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">127</span></pre></td><td class="code"><pre><span class="line">            type=<span class="string">"alphanumeric"</span> minLength=<span class="string">"0"</span> maxLength=<span class="string">"99"</span> defaultValue=<span class="string">"MBB"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">128</span></pre></td><td class="code"><pre><span class="line">        &lt;dataField id=<span class="string">"QRCancelOrderURL"</span> name=<span class="string">"QR Cancel Order URL"</span> access=<span class="string">"READWRITE"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">129</span></pre></td><td class="code"><pre><span class="line">            type=<span class="string">"alphanumeric"</span> minLength=<span class="string">"0"</span> maxLength=<span class="string">"99"</span> defaultValue=<span class="string">"MBB"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">130</span></pre></td><td class="code"><pre><span class="line">        &lt;dataField id=<span class="string">"QRWalletIDURL"</span> name=<span class="string">"QR Wallet ID URL"</span> access=<span class="string">"READWRITE"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">131</span></pre></td><td class="code"><pre><span class="line">            type=<span class="string">"alphanumeric"</span> minLength=<span class="string">"0"</span> maxLength=<span class="string">"99"</span> defaultValue=<span class="string">"MBB"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">132</span></pre></td><td class="code"><pre><span class="line">        &lt;dataField id=<span class="string">"QRRegisterURL"</span> name=<span class="string">"QR Register URL"</span> access=<span class="string">"READWRITE"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">133</span></pre></td><td class="code"><pre><span class="line">            type=<span class="string">"alphanumeric"</span> minLength=<span class="string">"0"</span> maxLength=<span class="string">"99"</span> defaultValue=<span class="string">"MBB"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">134</span></pre></td><td class="code"><pre><span class="line">        &lt;dataField id=<span class="string">"QRLogonURL"</span> name=<span class="string">"QR Logon URL"</span> access=<span class="string">"READWRITE"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">135</span></pre></td><td class="code"><pre><span class="line">            type=<span class="string">"alphanumeric"</span> minLength=<span class="string">"0"</span> maxLength=<span class="string">"99"</span> defaultValue=<span class="string">"MBB"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">136</span></pre></td><td class="code"><pre><span class="line">        &lt;dataField id=<span class="string">"QRMasterKey"</span> name=<span class="string">"QR Master Key"</span> access=<span class="string">"READWRITE"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">137</span></pre></td><td class="code"><pre><span class="line">            type=<span class="string">"alphanumeric"</span> minLength=<span class="string">"0"</span> maxLength=<span class="string">"64"</span> defaultValue=<span class="string">""</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">138</span></pre></td><td class="code"><pre><span class="line">        &lt;choiceField id=<span class="string">"TXQRSaleEnabled"</span> name=<span class="string">"QR Sale flag"</span> type=<span class="string">"SINGLE"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">139</span></pre></td><td class="code"><pre><span class="line">            defaultValue=<span class="string">"0"</span> access=<span class="string">"READWRITE"</span>&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">140</span></pre></td><td class="code"><pre><span class="line">            &lt;choiceValue label=<span class="string">"Disabled"</span> value=<span class="string">"0"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">141</span></pre></td><td class="code"><pre><span class="line">            &lt;choiceValue label=<span class="string">"Enabled"</span> value=<span class="string">"1"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">142</span></pre></td><td class="code"><pre><span class="line">        &lt;/choiceField&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">143</span></pre></td><td class="code"><pre><span class="line">        </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">144</span></pre></td><td class="code"><pre><span class="line">        &lt;!-- Terminal ID TABLE --&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">145</span></pre></td><td class="code"><pre><span class="line">        &lt;structureField id=<span class="string">"TerminalIds"</span> name=<span class="string">"TerminalIds"</span> access=<span class="string">"READWRITE"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">146</span></pre></td><td class="code"><pre><span class="line">            minRows=<span class="string">"0"</span> maxRows=<span class="string">"300"</span> uniqueKeys=<span class="string">"TidIndex"</span>&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">147</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">148</span></pre></td><td class="code"><pre><span class="line">            &lt;dataField id=<span class="string">"TidIndex"</span> name=<span class="string">"Index"</span> access=<span class="string">"READWRITE"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">149</span></pre></td><td class="code"><pre><span class="line">                type=<span class="string">"numeric"</span> minLength=<span class="string">"0"</span> maxLength=<span class="string">"3"</span> defaultValue=<span class="string">""</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">150</span></pre></td><td class="code"><pre><span class="line">                </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">151</span></pre></td><td class="code"><pre><span class="line">            &lt;dynamicChoiceField id=<span class="string">"TidHostIndex"</span> name=<span class="string">"Host Index"</span> access=<span class="string">"READWRITE"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">152</span></pre></td><td class="code"><pre><span class="line">                refFieldId=<span class="string">"Hosts"</span> refLabel=<span class="string">"HostName"</span> refValue=<span class="string">"HostIndex"</span>/&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">153</span></pre></td><td class="code"><pre><span class="line">    </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">154</span></pre></td><td class="code"><pre><span class="line">            &lt;dataField id=<span class="string">"TerminalId"</span> name=<span class="string">"Terminal ID"</span> access=<span class="string">"READWRITE"</span> type=<span class="string">"alphanumeric"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">155</span></pre></td><td class="code"><pre><span class="line">                minLength=<span class="string">"1"</span> maxLength=<span class="string">"8"</span> defaultValue=<span class="string">""</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">156</span></pre></td><td class="code"><pre><span class="line">            &lt;dataField id=<span class="string">"MerchantId"</span> name=<span class="string">"Merchant ID"</span> access=<span class="string">"READWRITE"</span> type=<span class="string">"alphanumeric"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">157</span></pre></td><td class="code"><pre><span class="line">                minLength=<span class="string">"1"</span> maxLength=<span class="string">"15"</span> defaultValue=<span class="string">""</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">158</span></pre></td><td class="code"><pre><span class="line">            </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">159</span></pre></td><td class="code"><pre><span class="line">            &lt;choiceField id=<span class="string">"AcquirerEnabled"</span> name=<span class="string">"Acquirer Enable"</span> type=<span class="string">"SINGLE"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">160</span></pre></td><td class="code"><pre><span class="line">            defaultValue=<span class="string">"1"</span> access=<span class="string">"READWRITE"</span>&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">161</span></pre></td><td class="code"><pre><span class="line">                &lt;choiceValue label=<span class="string">"Disabled"</span> value=<span class="string">"0"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">162</span></pre></td><td class="code"><pre><span class="line">                &lt;choiceValue label=<span class="string">"Enabled"</span> value=<span class="string">"1"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">163</span></pre></td><td class="code"><pre><span class="line">            &lt;/choiceField&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">164</span></pre></td><td class="code"><pre><span class="line">        &lt;/structureField&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">165</span></pre></td><td class="code"><pre><span class="line">        </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">166</span></pre></td><td class="code"><pre><span class="line">        &lt;!-- INSTALMENT TABLE --&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">167</span></pre></td><td class="code"><pre><span class="line">        &lt;structureField id=<span class="string">"Instalments"</span> name=<span class="string">"Instalments"</span> access=<span class="string">"READWRITE"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">168</span></pre></td><td class="code"><pre><span class="line">            minRows=<span class="string">"0"</span> maxRows=<span class="string">"300"</span> uniqueKeys=<span class="string">"InstalmentIndex"</span>&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">169</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">170</span></pre></td><td class="code"><pre><span class="line">            &lt;dataField id=<span class="string">"InstalmentIndex"</span> name=<span class="string">"Index"</span> access=<span class="string">"READWRITE"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">171</span></pre></td><td class="code"><pre><span class="line">                type=<span class="string">"numeric"</span> minLength=<span class="string">"1"</span> maxLength=<span class="string">"3"</span> defaultValue=<span class="string">""</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">172</span></pre></td><td class="code"><pre><span class="line">                            </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">173</span></pre></td><td class="code"><pre><span class="line">            &lt;dynamicChoiceField id=<span class="string">"InstalmentHostIndex"</span> name=<span class="string">"Host"</span> access=<span class="string">"READWRITE"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">174</span></pre></td><td class="code"><pre><span class="line">                refFieldId=<span class="string">"Hosts"</span> refLabel=<span class="string">"HostName"</span> refValue=<span class="string">"HostIndex"</span>/&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">175</span></pre></td><td class="code"><pre><span class="line">                </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">176</span></pre></td><td class="code"><pre><span class="line">            &lt;dataField id=<span class="string">"InstalmentDescription"</span> name=<span class="string">"Description"</span> access=<span class="string">"READWRITE"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">177</span></pre></td><td class="code"><pre><span class="line">                type=<span class="string">"alphanumeric"</span> minLength=<span class="string">"0"</span> maxLength=<span class="string">"20"</span> defaultValue=<span class="string">"EZP 0 MONTHS"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">178</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">179</span></pre></td><td class="code"><pre><span class="line">            &lt;dataField id=<span class="string">"InstallmentID"</span> name=<span class="string">"Installment ID"</span> access=<span class="string">"READWRITE"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">180</span></pre></td><td class="code"><pre><span class="line">                type=<span class="string">"numeric"</span> minLength=<span class="string">"1"</span> maxLength=<span class="string">"3"</span> defaultValue=<span class="string">""</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">181</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">182</span></pre></td><td class="code"><pre><span class="line">            &lt;dataField id=<span class="string">"InstalmentPeriod"</span> name=<span class="string">"Instalment Period (Months)"</span> access=<span class="string">"READWRITE"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">183</span></pre></td><td class="code"><pre><span class="line">                type=<span class="string">"numeric"</span> minLength=<span class="string">"1"</span> maxLength=<span class="string">"2"</span> defaultValue=<span class="string">""</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">184</span></pre></td><td class="code"><pre><span class="line">                    </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">185</span></pre></td><td class="code"><pre><span class="line">            &lt;dataField id=<span class="string">"InstalmentMinAmount"</span> name=<span class="string">"Instalment Minimum Amount (cents)"</span> access=<span class="string">"READWRITE"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">186</span></pre></td><td class="code"><pre><span class="line">                type=<span class="string">"numeric"</span> minLength=<span class="string">"1"</span> maxLength=<span class="string">"12"</span> defaultValue=<span class="string">"0"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">187</span></pre></td><td class="code"><pre><span class="line">            </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">188</span></pre></td><td class="code"><pre><span class="line">            &lt;choiceField id=<span class="string">"TenureEnabled"</span> name=<span class="string">"Tenure enabled"</span> type=<span class="string">"SINGLE"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">189</span></pre></td><td class="code"><pre><span class="line">                defaultValue=<span class="string">"1"</span> access=<span class="string">"READWRITE"</span>&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">190</span></pre></td><td class="code"><pre><span class="line">                &lt;choiceValue label=<span class="string">"Disabled"</span> value=<span class="string">"0"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">191</span></pre></td><td class="code"><pre><span class="line">                &lt;choiceValue label=<span class="string">"Enabled"</span> value=<span class="string">"1"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">192</span></pre></td><td class="code"><pre><span class="line">            &lt;/choiceField&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">193</span></pre></td><td class="code"><pre><span class="line">        &lt;/structureField&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">194</span></pre></td><td class="code"><pre><span class="line">        </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">195</span></pre></td><td class="code"><pre><span class="line">        &lt;!-- AMEX CONFIGURATION --&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">196</span></pre></td><td class="code"><pre><span class="line">        &lt;!--</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">197</span></pre></td><td class="code"><pre><span class="line">        &lt;choiceField id=<span class="string">"AmexHttpsHeaderEnabled"</span> name=<span class="string">"Amex HTTPS Header"</span> type=<span class="string">"SINGLE"</span> defaultValue=<span class="string">"1"</span> access=<span class="string">"READWRITE"</span>&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">198</span></pre></td><td class="code"><pre><span class="line">                &lt;choiceValue label=<span class="string">"Disabled"</span> value=<span class="string">"0"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">199</span></pre></td><td class="code"><pre><span class="line">                &lt;choiceValue label=<span class="string">"Enabled"</span> value=<span class="string">"1"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">200</span></pre></td><td class="code"><pre><span class="line">        &lt;/choiceField&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">201</span></pre></td><td class="code"><pre><span class="line">            </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">202</span></pre></td><td class="code"><pre><span class="line">        &lt;dataField id=<span class="string">"AmexOrigin"</span> name=<span class="string">"Amex Origin"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">203</span></pre></td><td class="code"><pre><span class="line">            access=<span class="string">"READWRITE"</span> type=<span class="string">"alphanumeric"</span> minLength=<span class="string">"1"</span> maxLength=<span class="string">"999"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">204</span></pre></td><td class="code"><pre><span class="line">            defaultValue=<span class="string">"MBB"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">205</span></pre></td><td class="code"><pre><span class="line">        &lt;dataField id=<span class="string">"AmexCountryCode"</span> name=<span class="string">"Amex Country Code"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">206</span></pre></td><td class="code"><pre><span class="line">            access=<span class="string">"READWRITE"</span> type=<span class="string">"numeric"</span> minLength=<span class="string">"3"</span> maxLength=<span class="string">"3"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">207</span></pre></td><td class="code"><pre><span class="line">            defaultValue=<span class="string">"458"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">208</span></pre></td><td class="code"><pre><span class="line">        &lt;dataField id=<span class="string">"AmexRegion"</span> name=<span class="string">"Amex Region"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">209</span></pre></td><td class="code"><pre><span class="line">            access=<span class="string">"READWRITE"</span> type=<span class="string">"alphanumeric"</span> minLength=<span class="string">"0"</span> maxLength=<span class="string">"10"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">210</span></pre></td><td class="code"><pre><span class="line">            defaultValue=<span class="string">"JAPA"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">211</span></pre></td><td class="code"><pre><span class="line">        &lt;dataField id=<span class="string">"AmexRoutingIndicator"</span> name=<span class="string">"Amex Routing Indicator"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">212</span></pre></td><td class="code"><pre><span class="line">            access=<span class="string">"READWRITE"</span> type=<span class="string">"numeric"</span> minLength=<span class="string">"0"</span> maxLength=<span class="string">"10"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">213</span></pre></td><td class="code"><pre><span class="line">            defaultValue=<span class="string">"050"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">214</span></pre></td><td class="code"><pre><span class="line">        --&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">215</span></pre></td><td class="code"><pre><span class="line">        </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">216</span></pre></td><td class="code"><pre><span class="line">        &lt;!-- EFTSEC TABLE --&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">217</span></pre></td><td class="code"><pre><span class="line">        &lt;structureField id=<span class="string">"eftsecConfig"</span> name=<span class="string">"EFTSEC Config"</span> access=<span class="string">"READWRITE"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">218</span></pre></td><td class="code"><pre><span class="line">            minRows=<span class="string">"0"</span> maxRows=<span class="string">"300"</span> uniqueKeys=<span class="string">"eftsecIndex"</span>&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">219</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">220</span></pre></td><td class="code"><pre><span class="line">            &lt;dataField id=<span class="string">"eftsecIndex"</span> name=<span class="string">"Index"</span> access=<span class="string">"READWRITE"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">221</span></pre></td><td class="code"><pre><span class="line">                type=<span class="string">"numeric"</span> minLength=<span class="string">"0"</span> maxLength=<span class="string">"3"</span> defaultValue=<span class="string">""</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">222</span></pre></td><td class="code"><pre><span class="line">            &lt;dataField id=<span class="string">"eftsecHostName"</span> name=<span class="string">"EFTSEC Host Name"</span> access=<span class="string">"READWRITE"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">223</span></pre></td><td class="code"><pre><span class="line">                type=<span class="string">"alphanumeric"</span> minLength=<span class="string">"0"</span> maxLength=<span class="string">"20"</span> defaultValue=<span class="string">"MBB"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">224</span></pre></td><td class="code"><pre><span class="line">            &lt;dataField id=<span class="string">"eftsecComHostName"</span> name=<span class="string">"Comms Host Name"</span> access=<span class="string">"READWRITE"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">225</span></pre></td><td class="code"><pre><span class="line">                type=<span class="string">"alphanumeric"</span> minLength=<span class="string">"0"</span> maxLength=<span class="string">"20"</span> defaultValue=<span class="string">""</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">226</span></pre></td><td class="code"><pre><span class="line">            &lt;choiceField id=<span class="string">"eftsecLEEnable"</span> name=<span class="string">"LE Enabled"</span> type=<span class="string">"SINGLE"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">227</span></pre></td><td class="code"><pre><span class="line">                defaultValue=<span class="string">"1"</span> access=<span class="string">"READWRITE"</span>&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">228</span></pre></td><td class="code"><pre><span class="line">                &lt;choiceValue label=<span class="string">"Disabled"</span> value=<span class="string">"0"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">229</span></pre></td><td class="code"><pre><span class="line">                &lt;choiceValue label=<span class="string">"Enabled"</span> value=<span class="string">"1"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">230</span></pre></td><td class="code"><pre><span class="line">            &lt;/choiceField&gt;  </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">231</span></pre></td><td class="code"><pre><span class="line">            &lt;dataField id=<span class="string">"eftsecRKSVendorID"</span> name=<span class="string">"Vendor ID"</span> access=<span class="string">"READWRITE"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">232</span></pre></td><td class="code"><pre><span class="line">                type=<span class="string">"alphanumeric"</span> minLength=<span class="string">"0"</span> maxLength=<span class="string">"8"</span> defaultValue=<span class="string">"00000002"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">233</span></pre></td><td class="code"><pre><span class="line">            &lt;dataField id=<span class="string">"eftsecRKSAcquirerID"</span> name=<span class="string">"Acquirer ID"</span> access=<span class="string">"READWRITE"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">234</span></pre></td><td class="code"><pre><span class="line">                type=<span class="string">"alphanumeric"</span> minLength=<span class="string">"0"</span> maxLength=<span class="string">"3"</span> defaultValue=<span class="string">"001"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">235</span></pre></td><td class="code"><pre><span class="line">            &lt;dataField id=<span class="string">"eftsecRKSLTID"</span> name=<span class="string">"LTID"</span> access=<span class="string">"READWRITE"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">236</span></pre></td><td class="code"><pre><span class="line">                type=<span class="string">"alphanumeric"</span> minLength=<span class="string">"0"</span> maxLength=<span class="string">"8"</span> defaultValue=<span class="string">"10000002"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">237</span></pre></td><td class="code"><pre><span class="line">            &lt;dataField id=<span class="string">"eftsecRKSEncryptionMethod"</span> name=<span class="string">"Encryption Method"</span> access=<span class="string">"READWRITE"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">238</span></pre></td><td class="code"><pre><span class="line">                type=<span class="string">"alphanumeric"</span> minLength=<span class="string">"0"</span> maxLength=<span class="string">"4"</span> defaultValue=<span class="string">"2221"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">239</span></pre></td><td class="code"><pre><span class="line">            &lt;dataField id=<span class="string">"eftsecRKSTPDU"</span> name=<span class="string">"TPDU"</span> access=<span class="string">"READWRITE"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">240</span></pre></td><td class="code"><pre><span class="line">                type=<span class="string">"alphanumeric"</span> minLength=<span class="string">"0"</span> maxLength=<span class="string">"10"</span> defaultValue=<span class="string">"6003550000"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">241</span></pre></td><td class="code"><pre><span class="line">        &lt;/structureField&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">242</span></pre></td><td class="code"><pre><span class="line">    &lt;/fields&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">243</span></pre></td><td class="code"><pre><span class="line">&lt;output&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">244</span></pre></td><td class="code"><pre><span class="line">        &lt;customParamFile</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">245</span></pre></td><td class="code"><pre><span class="line">            customClass=<span class="string">"com.ingenico.apac.ingestate.custom.RegistryParameterFileOutput"</span>&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">246</span></pre></td><td class="code"><pre><span class="line">            &lt;settings fileType=<span class="string">"sqlite"</span> fileName=<span class="string">"mbbconf.db"</span> rootKey=<span class="string">""</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">247</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">248</span></pre></td><td class="code"><pre><span class="line">            &lt;!-- TERMINAL ID --&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">249</span></pre></td><td class="code"><pre><span class="line">            &lt;structureOutput fieldId=<span class="string">"TerminalIds"</span> key=<span class="string">"TerminalIdTable"</span>&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">250</span></pre></td><td class="code"><pre><span class="line">                &lt;fieldOutput fieldId=<span class="string">"TidIndex"</span> key=<span class="string">"Index"</span> type=<span class="string">"UINT"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">251</span></pre></td><td class="code"><pre><span class="line">                &lt;fieldOutput fieldId=<span class="string">"TidHostIndex"</span> key=<span class="string">"HostIndex"</span> type=<span class="string">"UINT"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">252</span></pre></td><td class="code"><pre><span class="line">                &lt;fieldOutput fieldId=<span class="string">"TerminalId"</span> key=<span class="string">"TerminalId"</span> type=<span class="string">"STRING"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">253</span></pre></td><td class="code"><pre><span class="line">                &lt;fieldOutput fieldId=<span class="string">"MerchantId"</span> key=<span class="string">"MerchantId"</span> type=<span class="string">"STRING"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">254</span></pre></td><td class="code"><pre><span class="line">                &lt;fieldOutput fieldId=<span class="string">"AcquirerEnabled"</span> key=<span class="string">"AcquirerEnabled"</span> type=<span class="string">"BOOLEAN"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">255</span></pre></td><td class="code"><pre><span class="line">            &lt;/structureOutput&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">256</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">257</span></pre></td><td class="code"><pre><span class="line">            ...</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">258</span></pre></td><td class="code"><pre><span class="line">            </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">259</span></pre></td><td class="code"><pre><span class="line">            &lt;!-- INSTALMENTS --&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">260</span></pre></td><td class="code"><pre><span class="line">            &lt;structureOutput fieldId=<span class="string">"Instalments"</span> key=<span class="string">"InstalmentTable"</span>&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">261</span></pre></td><td class="code"><pre><span class="line">                &lt;fieldOutput fieldId=<span class="string">"InstalmentIndex"</span> key=<span class="string">"InstalmentIndex"</span> type=<span class="string">"UINT"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">262</span></pre></td><td class="code"><pre><span class="line">                &lt;fieldOutput fieldId=<span class="string">"InstalmentHostIndex"</span> key=<span class="string">"InstalmentHostIndex"</span> type=<span class="string">"UINT"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">263</span></pre></td><td class="code"><pre><span class="line">                &lt;fieldOutput fieldId=<span class="string">"InstalmentDescription"</span> key=<span class="string">"InstalmentDescription"</span> type=<span class="string">"STRING"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">264</span></pre></td><td class="code"><pre><span class="line">                &lt;fieldOutput fieldId=<span class="string">"InstallmentID"</span> key=<span class="string">"InstallmentID"</span> type=<span class="string">"UINT"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">265</span></pre></td><td class="code"><pre><span class="line">                &lt;fieldOutput fieldId=<span class="string">"InstalmentPeriod"</span> key=<span class="string">"InstalmentPeriod"</span> type=<span class="string">"UINT"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">266</span></pre></td><td class="code"><pre><span class="line">                &lt;fieldOutput fieldId=<span class="string">"InstalmentMinAmount"</span> key=<span class="string">"InstalmentMinAmount"</span> type=<span class="string">"UINT"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">267</span></pre></td><td class="code"><pre><span class="line">                &lt;fieldOutput fieldId=<span class="string">"TenureEnabled"</span> key=<span class="string">"TenureEnabled"</span> type=<span class="string">"BOOLEAN"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">268</span></pre></td><td class="code"><pre><span class="line">            &lt;/structureOutput&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">269</span></pre></td><td class="code"><pre><span class="line">        </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">270</span></pre></td><td class="code"><pre><span class="line">            </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">271</span></pre></td><td class="code"><pre><span class="line">            &lt;!-- EFTSEC TABLE --&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">272</span></pre></td><td class="code"><pre><span class="line">            &lt;structureOutput fieldId=<span class="string">"eftsecConfig"</span> key=<span class="string">"EFTSECTable"</span>&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">273</span></pre></td><td class="code"><pre><span class="line">                &lt;fieldOutput fieldId=<span class="string">"eftsecIndex"</span> key=<span class="string">"Index"</span> type=<span class="string">"UINT"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">274</span></pre></td><td class="code"><pre><span class="line">                &lt;fieldOutput fieldId=<span class="string">"eftsecHostName"</span> key=<span class="string">"eftsecHostName"</span> type=<span class="string">"STRING"</span> /&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">275</span></pre></td><td class="code"><pre><span class="line">            &lt;/structureOutput&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">276</span></pre></td><td class="code"><pre><span class="line">        &lt;/customParamFile&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">277</span></pre></td><td class="code"><pre><span class="line">    &lt;/output&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">278</span></pre></td><td class="code"><pre><span class="line">&lt;/template&gt;</span></pre></td></tr></table></figure></li>
<li><p>解析代码</p>
<figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="comment"># 生成 template 字符串</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> getTemplate(<span class="variable">$version</span>,<span class="variable">$nodes</span>)&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"><span class="variable">$template</span> = <span class="string">@"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line"><span class="string">&#123;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line"><span class="string">  "templateName": "xxx.Config.Parameters",</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line"><span class="string">  "templateVersion": "<span class="variable">$version</span>",</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line"><span class="string">  "output": &#123;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line"><span class="string">    "type": "xml",</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line"><span class="string">    "fileName": "xxx.config.xml",</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line"><span class="string">    "keyNameLevel0": "node",</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line"><span class="string">    "keyNameLevel1": "node",</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line"><span class="string">    "keyNameLevel2": "node",</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line"><span class="string">    "attrNameLevel0": "tag",</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line"><span class="string">    "attrNameLevel1": "tag",</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line"><span class="string">    "attrNameLevel2": "tag"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">16</span></pre></td><td class="code"><pre><span class="line"><span class="string">  &#125;,</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">17</span></pre></td><td class="code"><pre><span class="line"><span class="string">   "nodes":[<span class="variable">$nodes</span>]</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">18</span></pre></td><td class="code"><pre><span class="line"><span class="string">  &#125;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">19</span></pre></td><td class="code"><pre><span class="line"><span class="string">"@</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">20</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> <span class="variable">$template</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">21</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">22</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">23</span></pre></td><td class="code"><pre><span class="line"><span class="comment"># 生成 tab 字符串</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">24</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> getTabString(<span class="variable">$key</span>,<span class="variable">$name</span>,<span class="variable">$fields</span>)&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">25</span></pre></td><td class="code"><pre><span class="line"><span class="variable">$tab</span> = <span class="string">@"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">26</span></pre></td><td class="code"><pre><span class="line"><span class="string">&#123;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">27</span></pre></td><td class="code"><pre><span class="line"><span class="string">    "key": "<span class="variable">$key</span>",</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">28</span></pre></td><td class="code"><pre><span class="line"><span class="string">    "name": "<span class="variable">$name</span>",</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">29</span></pre></td><td class="code"><pre><span class="line"><span class="string">    "layoutType": "tab",</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">30</span></pre></td><td class="code"><pre><span class="line"><span class="string">    "fields":[<span class="variable">$fields</span>]</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">31</span></pre></td><td class="code"><pre><span class="line"><span class="string">&#125;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">32</span></pre></td><td class="code"><pre><span class="line"><span class="string">"@</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">33</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> <span class="variable">$tab</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">34</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">35</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">36</span></pre></td><td class="code"><pre><span class="line"><span class="comment"># 生成 datagrid 字符串</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">37</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> getDatagrid(<span class="variable">$key</span>,<span class="variable">$name</span>,<span class="variable">$fields</span>)&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">38</span></pre></td><td class="code"><pre><span class="line"><span class="variable">$datagrid</span> = <span class="string">@"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">39</span></pre></td><td class="code"><pre><span class="line"><span class="string">&#123;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">40</span></pre></td><td class="code"><pre><span class="line"><span class="string">    "key": "<span class="variable">$key</span>",</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">41</span></pre></td><td class="code"><pre><span class="line"><span class="string">    "name": "<span class="variable">$name</span>",</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">42</span></pre></td><td class="code"><pre><span class="line"><span class="string">    "layoutType": "datagrid",</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">43</span></pre></td><td class="code"><pre><span class="line"><span class="string">    "fields": [<span class="variable">$fields</span>]</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">44</span></pre></td><td class="code"><pre><span class="line"><span class="string">&#125;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">45</span></pre></td><td class="code"><pre><span class="line"><span class="string">"@</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">46</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> <span class="variable">$datagrid</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">47</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">48</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">49</span></pre></td><td class="code"><pre><span class="line"><span class="comment"># 生成 text element 字符串</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">50</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> getTextElement(<span class="variable">$key</span>,<span class="variable">$name</span>,<span class="variable">$defaultValue</span>,<span class="variable">$min</span>,<span class="variable">$max</span>)&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">51</span></pre></td><td class="code"><pre><span class="line"><span class="variable">$txtElement</span> = <span class="string">@"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">52</span></pre></td><td class="code"><pre><span class="line"><span class="string">&#123;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">53</span></pre></td><td class="code"><pre><span class="line"><span class="string">    "key": "<span class="variable">$key</span>",</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">54</span></pre></td><td class="code"><pre><span class="line"><span class="string">    "name": "<span class="variable">$name</span>",</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">55</span></pre></td><td class="code"><pre><span class="line"><span class="string">    "defValue": "<span class="variable">$defaultValue</span>",</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">56</span></pre></td><td class="code"><pre><span class="line"><span class="string">    "layoutType": "text",</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">57</span></pre></td><td class="code"><pre><span class="line"><span class="string">    "minLength": <span class="variable">$min</span>,</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">58</span></pre></td><td class="code"><pre><span class="line"><span class="string">    "maxLength": <span class="variable">$max</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">59</span></pre></td><td class="code"><pre><span class="line"><span class="string">&#125;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">60</span></pre></td><td class="code"><pre><span class="line"><span class="string">"@</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">61</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> <span class="variable">$txtElement</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">62</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">63</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">64</span></pre></td><td class="code"><pre><span class="line"><span class="comment"># 生成 radio 字符串</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">65</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> getRadioElement(<span class="variable">$key</span>,<span class="variable">$name</span>,<span class="variable">$defaultValue</span>,<span class="variable">$fields</span>)&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">66</span></pre></td><td class="code"><pre><span class="line"><span class="variable">$radioElement</span> = <span class="string">@"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">67</span></pre></td><td class="code"><pre><span class="line"><span class="string">&#123;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">68</span></pre></td><td class="code"><pre><span class="line"><span class="string">    "key": "<span class="variable">$key</span>",</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">69</span></pre></td><td class="code"><pre><span class="line"><span class="string">    "name": "<span class="variable">$name</span>",</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">70</span></pre></td><td class="code"><pre><span class="line"><span class="string">    "defValue": "<span class="variable">$defaultValue</span>",</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">71</span></pre></td><td class="code"><pre><span class="line"><span class="string">    "type": "bool",</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">72</span></pre></td><td class="code"><pre><span class="line"><span class="string">    "layoutType": "radio",</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">73</span></pre></td><td class="code"><pre><span class="line"><span class="string">    "choiceValue": &#123;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">74</span></pre></td><td class="code"><pre><span class="line"><span class="string">    "fields": [<span class="variable">$fields</span>]</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">75</span></pre></td><td class="code"><pre><span class="line"><span class="string">    &#125;,</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">76</span></pre></td><td class="code"><pre><span class="line"><span class="string">    "trueValue": "true",</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">77</span></pre></td><td class="code"><pre><span class="line"><span class="string">    "falseValue": "false"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">78</span></pre></td><td class="code"><pre><span class="line"><span class="string">&#125;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">79</span></pre></td><td class="code"><pre><span class="line"><span class="string">"@</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">80</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> <span class="variable">$radioElement</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">81</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">82</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">83</span></pre></td><td class="code"><pre><span class="line"><span class="comment"># 声 dropDown element</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">84</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> getDropdownElement(<span class="variable">$key</span>,<span class="variable">$name</span>,<span class="variable">$defaultValue</span>,<span class="variable">$fields</span>)&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">85</span></pre></td><td class="code"><pre><span class="line"><span class="variable">$dropdown</span> = <span class="string">@"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">86</span></pre></td><td class="code"><pre><span class="line"><span class="string">&#123;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">87</span></pre></td><td class="code"><pre><span class="line"><span class="string">    "key": "<span class="variable">$key</span>",</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">88</span></pre></td><td class="code"><pre><span class="line"><span class="string">    "name": "<span class="variable">$name</span>",</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">89</span></pre></td><td class="code"><pre><span class="line"><span class="string">    "defValue": "<span class="variable">$defaultValue</span>",</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">90</span></pre></td><td class="code"><pre><span class="line"><span class="string">    "layoutType": "dropdown",</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">91</span></pre></td><td class="code"><pre><span class="line"><span class="string">    "choiceValue": &#123;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">92</span></pre></td><td class="code"><pre><span class="line"><span class="string">    "fields": [<span class="variable">$fields</span>]</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">93</span></pre></td><td class="code"><pre><span class="line"><span class="string">  &#125;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">94</span></pre></td><td class="code"><pre><span class="line"><span class="string">&#125;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">95</span></pre></td><td class="code"><pre><span class="line"><span class="string">"@</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">96</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> <span class="variable">$dropdown</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">97</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">98</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">99</span></pre></td><td class="code"><pre><span class="line"><span class="comment"># 生成 fileds element</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">100</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> getFildesElement(<span class="variable">$key</span>,<span class="variable">$value</span>)&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">101</span></pre></td><td class="code"><pre><span class="line"><span class="variable">$fieldElement</span> = <span class="string">@"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">102</span></pre></td><td class="code"><pre><span class="line"><span class="string">&#123;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">103</span></pre></td><td class="code"><pre><span class="line"><span class="string">    "name":"<span class="variable">$key</span>",</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">104</span></pre></td><td class="code"><pre><span class="line"><span class="string">    "value":"<span class="variable">$value</span>"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">105</span></pre></td><td class="code"><pre><span class="line"><span class="string">&#125;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">106</span></pre></td><td class="code"><pre><span class="line"><span class="string">"@</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">107</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> <span class="variable">$fieldElement</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">108</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">109</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">110</span></pre></td><td class="code"><pre><span class="line"><span class="comment"># get value by id</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">111</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> getValueById(<span class="variable">$id</span>)&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">112</span></pre></td><td class="code"><pre><span class="line">    <span class="keyword">if</span>(<span class="variable">$id</span> -and <span class="variable">$outputMap</span>.Contains(<span class="variable">$id</span>))&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">113</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">return</span> <span class="variable">$outputMap</span>[<span class="variable">$id</span>]</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">114</span></pre></td><td class="code"><pre><span class="line">    &#125;<span class="keyword">else</span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">115</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">return</span> <span class="variable">$id</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">116</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">117</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">118</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">119</span></pre></td><td class="code"><pre><span class="line"><span class="comment"># 获取 structureField json 字符串: 等价于一个 tab</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">120</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> getStructureFieldNodeJson(<span class="variable">$structureField</span>)&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">121</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">122</span></pre></td><td class="code"><pre><span class="line">    <span class="comment"># tab key 值</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">123</span></pre></td><td class="code"><pre><span class="line">    <span class="variable">$tabKey</span> = getValueById <span class="variable">$structureField</span>.id</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">124</span></pre></td><td class="code"><pre><span class="line">    <span class="comment"># tab name 值</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">125</span></pre></td><td class="code"><pre><span class="line">    <span class="variable">$tabName</span> = <span class="variable">$structureField</span>.name</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">126</span></pre></td><td class="code"><pre><span class="line">    <span class="comment"># tab fields 内容</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">127</span></pre></td><td class="code"><pre><span class="line">    <span class="variable">$tabFields</span> = <span class="string">""</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">128</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">129</span></pre></td><td class="code"><pre><span class="line">    <span class="comment"># 获取 structureField 所有元素，生成 datagrid json 字符串</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">130</span></pre></td><td class="code"><pre><span class="line">    <span class="variable">$childNodes</span> = <span class="variable">$structureField</span>.ChildNodes</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">131</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">132</span></pre></td><td class="code"><pre><span class="line">    <span class="comment"># 生成 datagrid 元素</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">133</span></pre></td><td class="code"><pre><span class="line">    <span class="variable">$datagridKey</span> = getValueById <span class="variable">$structureField</span>.id</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">134</span></pre></td><td class="code"><pre><span class="line">    <span class="variable">$datagridName</span> = <span class="variable">$structureField</span>.name</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">135</span></pre></td><td class="code"><pre><span class="line">    <span class="variable">$datagridBody</span> = <span class="string">""</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">136</span></pre></td><td class="code"><pre><span class="line">    <span class="variable">$datagridFields</span> =<span class="string">""</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">137</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">138</span></pre></td><td class="code"><pre><span class="line">    <span class="comment"># 遍历所有子节点</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">139</span></pre></td><td class="code"><pre><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>;<span class="variable">$i</span> <span class="nomarkup">-lt</span> <span class="variable">$childNodes</span>.Count;<span class="variable">$i</span>++)&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">140</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">141</span></pre></td><td class="code"><pre><span class="line">        <span class="variable">$key</span> = getValueById <span class="variable">$childNodes</span>[<span class="variable">$i</span>].id</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">142</span></pre></td><td class="code"><pre><span class="line">        <span class="variable">$name</span> = <span class="variable">$childNodes</span>[<span class="variable">$i</span>].name</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">143</span></pre></td><td class="code"><pre><span class="line">        <span class="variable">$default</span> = <span class="variable">$childNodes</span>[<span class="variable">$i</span>].defaultValue</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">144</span></pre></td><td class="code"><pre><span class="line">        <span class="variable">$field</span> = <span class="string">""</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">145</span></pre></td><td class="code"><pre><span class="line">        <span class="variable">$body</span> = <span class="string">""</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">146</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">147</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">if</span>(<span class="variable">$childNodes</span>[<span class="variable">$i</span>].LocalName.Equals(<span class="string">"choiceField"</span>))&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">148</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">149</span></pre></td><td class="code"><pre><span class="line">            <span class="keyword">for</span>(<span class="variable">$j</span>=<span class="number">0</span>;<span class="variable">$j</span> <span class="nomarkup">-lt</span> <span class="variable">$childNodes</span>[<span class="variable">$i</span>].ChildNodes.Count;<span class="variable">$j</span>++)&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">150</span></pre></td><td class="code"><pre><span class="line">                <span class="comment"># 排除掉注释语句</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">151</span></pre></td><td class="code"><pre><span class="line">                <span class="keyword">if</span>(!<span class="variable">$childNodes</span>[<span class="variable">$i</span>].ChildNodes[<span class="variable">$j</span>].NodeType.ToString().Equals(<span class="string">"Comment"</span>))&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">152</span></pre></td><td class="code"><pre><span class="line">                    <span class="comment"># 生成 fields 子元素 json 字符串</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">153</span></pre></td><td class="code"><pre><span class="line">                    <span class="variable">$field</span> += (getFildesElement <span class="variable">$childNodes</span>[<span class="variable">$i</span>].ChildNodes[<span class="variable">$j</span>].label <span class="variable">$childNodes</span>[<span class="variable">$i</span>].ChildNodes[<span class="variable">$j</span>].value) + <span class="string">","</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">154</span></pre></td><td class="code"><pre><span class="line">                &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">155</span></pre></td><td class="code"><pre><span class="line">            &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">156</span></pre></td><td class="code"><pre><span class="line">       </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">157</span></pre></td><td class="code"><pre><span class="line">            <span class="comment"># 生成 dropdown 元素 json 字符串</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">158</span></pre></td><td class="code"><pre><span class="line">            <span class="variable">$body</span> = (getDropdownElement <span class="variable">$key</span> <span class="variable">$name</span> <span class="variable">$default</span> <span class="variable">$field</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">159</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">160</span></pre></td><td class="code"><pre><span class="line">        &#125;<span class="keyword">elseif</span>(<span class="variable">$childNodes</span>[<span class="variable">$i</span>].LocalName.Equals(<span class="string">"dataField"</span>))&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">161</span></pre></td><td class="code"><pre><span class="line">            <span class="variable">$min</span> = <span class="variable">$childNodes</span>[<span class="variable">$i</span>].minLength</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">162</span></pre></td><td class="code"><pre><span class="line">            <span class="variable">$max</span> = <span class="variable">$childNodes</span>[<span class="variable">$i</span>].maxLength</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">163</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">164</span></pre></td><td class="code"><pre><span class="line">            <span class="comment"># 生成 txt 元素 json 字符串</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">165</span></pre></td><td class="code"><pre><span class="line">            <span class="variable">$body</span> = (getTextElement <span class="variable">$key</span> <span class="variable">$name</span> <span class="variable">$default</span> <span class="variable">$min</span> <span class="variable">$max</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">166</span></pre></td><td class="code"><pre><span class="line">    </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">167</span></pre></td><td class="code"><pre><span class="line">        &#125;<span class="keyword">elseif</span>(<span class="variable">$childNodes</span>[<span class="variable">$i</span>].LocalName.Equals(<span class="string">"dynamicChoiceField"</span>))&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">168</span></pre></td><td class="code"><pre><span class="line">            <span class="variable">$min</span> = <span class="number">0</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">169</span></pre></td><td class="code"><pre><span class="line">            <span class="variable">$max</span> = <span class="number">12</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">170</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">171</span></pre></td><td class="code"><pre><span class="line">            <span class="comment"># 生成 txt 元素 json 字符串</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">172</span></pre></td><td class="code"><pre><span class="line">            <span class="variable">$body</span> = (getTextElement <span class="variable">$key</span> <span class="variable">$name</span> <span class="variable">$default</span> <span class="variable">$min</span> <span class="variable">$max</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">173</span></pre></td><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">174</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">175</span></pre></td><td class="code"><pre><span class="line">        <span class="comment"># 排除注释节点</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">176</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">if</span>(!<span class="variable">$body</span>.Equals(<span class="string">""</span>))&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">177</span></pre></td><td class="code"><pre><span class="line">            <span class="variable">$datagridFields</span> += <span class="variable">$body</span> + <span class="string">","</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">178</span></pre></td><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">179</span></pre></td><td class="code"><pre><span class="line">    </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">180</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">181</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">182</span></pre></td><td class="code"><pre><span class="line">    <span class="comment"># 合成生成最终的 datagrid json 字符串</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">183</span></pre></td><td class="code"><pre><span class="line">    <span class="variable">$datagridBody</span> = getDatagrid <span class="variable">$datagridKey</span> <span class="variable">$datagridName</span> <span class="variable">$datagridFields</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">184</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">185</span></pre></td><td class="code"><pre><span class="line">    <span class="comment"># 拼接 tab fields json 字符串</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">186</span></pre></td><td class="code"><pre><span class="line">    <span class="variable">$tabFields</span> += <span class="variable">$datagridBody</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">187</span></pre></td><td class="code"><pre><span class="line">    <span class="comment"># 生成最终 tab 元素 json 字符串</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">188</span></pre></td><td class="code"><pre><span class="line">    <span class="variable">$tabBody</span> = getTabString <span class="variable">$tabKey</span> <span class="variable">$tabName</span> <span class="variable">$tabFields</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">189</span></pre></td><td class="code"><pre><span class="line">    <span class="keyword">return</span> <span class="variable">$tabBody</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">190</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">191</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">192</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">193</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">194</span></pre></td><td class="code"><pre><span class="line"><span class="comment"># 读取 xml 配置文件</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">195</span></pre></td><td class="code"><pre><span class="line"><span class="variable">$commXmlData</span> = [xml](<span class="built_in">Get-Content</span> mbbconf.xml)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">196</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">197</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">198</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">199</span></pre></td><td class="code"><pre><span class="line"><span class="comment"># 存储 output id 和 key 值</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">200</span></pre></td><td class="code"><pre><span class="line"><span class="variable">$outputMap</span> = @&#123;&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">201</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">202</span></pre></td><td class="code"><pre><span class="line"><span class="comment"># 获取 output -&gt; fieldOutput 节点映射 id 值</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">203</span></pre></td><td class="code"><pre><span class="line"><span class="variable">$fieldOutputXmlData</span> = <span class="variable">$commXmlData</span>.template.output.customParamFile.fieldOutput</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">204</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>;<span class="variable">$i</span> <span class="nomarkup">-lt</span> <span class="variable">$fieldOutputXmlData</span>.Count;<span class="variable">$i</span>++)&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">205</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">206</span></pre></td><td class="code"><pre><span class="line">    <span class="keyword">if</span>(<span class="variable">$fieldOutputXmlData</span>[<span class="variable">$i</span>].fieldId -and !<span class="variable">$fieldOutputXmlData</span>[<span class="variable">$i</span>].NodeType.ToString().Equals(<span class="string">"Comment"</span>))&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">207</span></pre></td><td class="code"><pre><span class="line">        <span class="comment"># 提取 / 第二个元素</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">208</span></pre></td><td class="code"><pre><span class="line">        <span class="variable">$outputMap</span>[<span class="variable">$fieldOutputXmlData</span>[<span class="variable">$i</span>].fieldId] = <span class="variable">$fieldOutputXmlData</span>[<span class="variable">$i</span>].key.Split(<span class="string">"/"</span>)[<span class="number">1</span>]</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">209</span></pre></td><td class="code"><pre><span class="line">        <span class="built_in">Write-Host</span> <span class="variable">$fieldOutputXmlData</span>[<span class="variable">$i</span>].fieldId : <span class="variable">$outputMap</span>[<span class="variable">$fieldOutputXmlData</span>[<span class="variable">$i</span>].fieldId]</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">210</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">211</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">212</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">213</span></pre></td><td class="code"><pre><span class="line"><span class="comment"># 获取 output -&gt; structureOutput 节点映射 id 值</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">214</span></pre></td><td class="code"><pre><span class="line"><span class="variable">$structureOutputXmlData</span> = <span class="variable">$commXmlData</span>.template.output.customParamFile.structureOutput</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">215</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>;<span class="variable">$i</span> <span class="nomarkup">-lt</span> <span class="variable">$structureOutputXmlData</span>.Count;<span class="variable">$i</span>++)&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">216</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">217</span></pre></td><td class="code"><pre><span class="line">    <span class="keyword">if</span>(<span class="variable">$structureOutputXmlData</span>[<span class="variable">$i</span>].fieldId -and !<span class="variable">$structureOutputXmlData</span>[<span class="variable">$i</span>].NodeType.ToString().Equals(<span class="string">"Comment"</span>))&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">218</span></pre></td><td class="code"><pre><span class="line">        <span class="variable">$outputMap</span>[<span class="variable">$structureOutputXmlData</span>[<span class="variable">$i</span>].fieldId] = <span class="variable">$structureOutputXmlData</span>[<span class="variable">$i</span>].key</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">219</span></pre></td><td class="code"><pre><span class="line">        <span class="built_in">Write-Host</span> <span class="string">'*** '</span> <span class="variable">$structureOutputXmlData</span>[<span class="variable">$i</span>].fieldId : <span class="variable">$outputMap</span>[<span class="variable">$structureOutputXmlData</span>[<span class="variable">$i</span>].fieldId]</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">220</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">221</span></pre></td><td class="code"><pre><span class="line">        <span class="comment"># structureOutput -&gt; fieldOutput</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">222</span></pre></td><td class="code"><pre><span class="line">        <span class="variable">$child</span> = <span class="variable">$structureOutputXmlData</span>.fieldOutput</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">223</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">for</span>(<span class="variable">$j</span>=<span class="number">0</span>;<span class="variable">$j</span> <span class="nomarkup">-lt</span> <span class="variable">$child</span>.Count;<span class="variable">$j</span>++)&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">224</span></pre></td><td class="code"><pre><span class="line">            <span class="keyword">if</span>(<span class="variable">$child</span>[<span class="variable">$j</span>].fieldId -and !<span class="variable">$child</span>[<span class="variable">$j</span>].NodeType.ToString().Equals(<span class="string">"Comment"</span>))&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">225</span></pre></td><td class="code"><pre><span class="line">                <span class="variable">$outputMap</span>[<span class="variable">$child</span>[<span class="variable">$j</span>].fieldId] = <span class="variable">$child</span>[<span class="variable">$j</span>].key</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">226</span></pre></td><td class="code"><pre><span class="line">                <span class="built_in">Write-Host</span> <span class="variable">$child</span>[<span class="variable">$j</span>].fieldId : <span class="variable">$outputMap</span>[<span class="variable">$child</span>[<span class="variable">$j</span>].fieldId]</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">227</span></pre></td><td class="code"><pre><span class="line">            &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">228</span></pre></td><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">229</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">230</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">231</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">232</span></pre></td><td class="code"><pre><span class="line"><span class="built_in">Write-Host</span> <span class="string">"outMap length: "</span> <span class="variable">$outputMap</span>.Count</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">233</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">234</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">235</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">236</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">237</span></pre></td><td class="code"><pre><span class="line"><span class="comment"># template nodes</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">238</span></pre></td><td class="code"><pre><span class="line"><span class="variable">$templateNodes</span> = <span class="string">""</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">239</span></pre></td><td class="code"><pre><span class="line"><span class="comment"># template version</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">240</span></pre></td><td class="code"><pre><span class="line"><span class="variable">$templateVsersion</span> = <span class="variable">$commXmlData</span>.template.version</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">241</span></pre></td><td class="code"><pre><span class="line"><span class="comment"># template key 值</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">242</span></pre></td><td class="code"><pre><span class="line"><span class="variable">$templateKey</span> = <span class="variable">$commXmlData</span>.template.id</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">243</span></pre></td><td class="code"><pre><span class="line"><span class="comment"># template name 值</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">244</span></pre></td><td class="code"><pre><span class="line"><span class="variable">$templateName</span> = <span class="variable">$commXmlData</span>.template.name</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">245</span></pre></td><td class="code"><pre><span class="line"><span class="comment"># template 内容用于生成最终的 json 文件</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">246</span></pre></td><td class="code"><pre><span class="line"><span class="variable">$templateBody</span> = <span class="string">""</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">247</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">248</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">249</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">250</span></pre></td><td class="code"><pre><span class="line"><span class="comment"># fields nodes</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">251</span></pre></td><td class="code"><pre><span class="line"><span class="variable">$fieldsChildNodes</span> = <span class="variable">$commXmlData</span>.template.fields.ChildNodes</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">252</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">253</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">254</span></pre></td><td class="code"><pre><span class="line"><span class="comment"># terminal config tab key 值</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">255</span></pre></td><td class="code"><pre><span class="line"><span class="variable">$terminalConfigTabKey</span> = <span class="string">"TerminalConfig"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">256</span></pre></td><td class="code"><pre><span class="line"><span class="comment"># terminal config tab name 值</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">257</span></pre></td><td class="code"><pre><span class="line"><span class="variable">$terminalConfigTabName</span> = <span class="string">"TerminalConfig"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">258</span></pre></td><td class="code"><pre><span class="line"><span class="comment"># terminal config tab tab fields 内容</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">259</span></pre></td><td class="code"><pre><span class="line"><span class="variable">$terminalConfigTabFields</span> = <span class="string">""</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">260</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">261</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="variable">$k</span>=<span class="number">0</span>;<span class="variable">$k</span> <span class="nomarkup">-lt</span> <span class="variable">$fieldsChildNodes</span>.Count;<span class="variable">$k</span>++)&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">262</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">263</span></pre></td><td class="code"><pre><span class="line">    <span class="variable">$key</span> = getValueById <span class="variable">$fieldsChildNodes</span>[<span class="variable">$k</span>].id</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">264</span></pre></td><td class="code"><pre><span class="line">    <span class="variable">$name</span> = <span class="variable">$fieldsChildNodes</span>[<span class="variable">$k</span>].name</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">265</span></pre></td><td class="code"><pre><span class="line">    <span class="variable">$default</span> = <span class="variable">$fieldsChildNodes</span>[<span class="variable">$k</span>].defaultValue</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">266</span></pre></td><td class="code"><pre><span class="line">    <span class="variable">$field</span> = <span class="string">""</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">267</span></pre></td><td class="code"><pre><span class="line">    <span class="variable">$body</span> = <span class="string">""</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">268</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">269</span></pre></td><td class="code"><pre><span class="line">    <span class="keyword">if</span>(<span class="variable">$fieldsChildNodes</span>[<span class="variable">$k</span>].LocalName.Equals(<span class="string">"choiceField"</span>))&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">270</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">271</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">for</span>(<span class="variable">$l</span>=<span class="number">0</span>;<span class="variable">$l</span> <span class="nomarkup">-lt</span> <span class="variable">$fieldsChildNodes</span>[<span class="variable">$k</span>].ChildNodes.Count;<span class="variable">$l</span>++)&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">272</span></pre></td><td class="code"><pre><span class="line">            <span class="comment"># 排除掉注释语句</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">273</span></pre></td><td class="code"><pre><span class="line">            <span class="keyword">if</span>(!<span class="variable">$fieldsChildNodes</span>[<span class="variable">$k</span>].ChildNodes[<span class="variable">$l</span>].NodeType.ToString().Equals(<span class="string">"Comment"</span>))&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">274</span></pre></td><td class="code"><pre><span class="line">            <span class="comment"># 生成 fields 子元素 json 字符串</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">275</span></pre></td><td class="code"><pre><span class="line">                <span class="variable">$field</span> += (getFildesElement <span class="variable">$fieldsChildNodes</span>[<span class="variable">$k</span>].ChildNodes[<span class="variable">$l</span>].label <span class="variable">$fieldsChildNodes</span>[<span class="variable">$k</span>].ChildNodes[<span class="variable">$l</span>].value) + <span class="string">","</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">276</span></pre></td><td class="code"><pre><span class="line">            &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">277</span></pre></td><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">278</span></pre></td><td class="code"><pre><span class="line">       </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">279</span></pre></td><td class="code"><pre><span class="line">        <span class="comment"># 生成 dropdown 元素 json 字符串</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">280</span></pre></td><td class="code"><pre><span class="line">        <span class="variable">$body</span> = (getDropdownElement <span class="variable">$key</span> <span class="variable">$name</span> <span class="variable">$default</span> <span class="variable">$field</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">281</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">282</span></pre></td><td class="code"><pre><span class="line">    &#125;<span class="keyword">elseif</span>(<span class="variable">$fieldsChildNodes</span>[<span class="variable">$k</span>].LocalName.Equals(<span class="string">"dataField"</span>))&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">283</span></pre></td><td class="code"><pre><span class="line">        <span class="variable">$min</span> = <span class="variable">$fieldsChildNodes</span>[<span class="variable">$k</span>].minLength</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">284</span></pre></td><td class="code"><pre><span class="line">        <span class="variable">$max</span> = <span class="variable">$fieldsChildNodes</span>[<span class="variable">$k</span>].maxLength</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">285</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">286</span></pre></td><td class="code"><pre><span class="line">        <span class="comment"># 生成 txt 元素 json 字符串</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">287</span></pre></td><td class="code"><pre><span class="line">        <span class="variable">$body</span> = (getTextElement <span class="variable">$key</span> <span class="variable">$name</span> <span class="variable">$default</span> <span class="variable">$min</span> <span class="variable">$max</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">288</span></pre></td><td class="code"><pre><span class="line">    </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">289</span></pre></td><td class="code"><pre><span class="line">    &#125;<span class="keyword">elseif</span>(<span class="variable">$fieldsChildNodes</span>[<span class="variable">$k</span>].LocalName.Equals(<span class="string">"structureField"</span>))&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">290</span></pre></td><td class="code"><pre><span class="line">        <span class="comment"># 获取各个 tab json string</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">291</span></pre></td><td class="code"><pre><span class="line">        <span class="variable">$templateNodes</span> += (getStructureFieldNodeJson <span class="variable">$fieldsChildNodes</span>[<span class="variable">$k</span>]) + <span class="string">","</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">292</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">293</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">294</span></pre></td><td class="code"><pre><span class="line">    <span class="comment"># 排除注释节点</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">295</span></pre></td><td class="code"><pre><span class="line">    <span class="keyword">if</span>(!<span class="variable">$body</span>.Equals(<span class="string">""</span>))&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">296</span></pre></td><td class="code"><pre><span class="line">        <span class="variable">$terminalConfigTabFields</span> += <span class="variable">$body</span> + <span class="string">","</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">297</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">298</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">299</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">300</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">301</span></pre></td><td class="code"><pre><span class="line"><span class="comment"># 生成最终 terminal config tab 元素 json 字符串</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">302</span></pre></td><td class="code"><pre><span class="line"><span class="variable">$terminalConfigTabBody</span> = getTabString <span class="variable">$terminalConfigTabKey</span> <span class="variable">$terminalConfigTabName</span> <span class="variable">$terminalConfigTabFields</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">303</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">304</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">305</span></pre></td><td class="code"><pre><span class="line"><span class="comment"># 拼接生成 template nodes 元素 json 字符串</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">306</span></pre></td><td class="code"><pre><span class="line"><span class="variable">$templateNodes</span> +=  <span class="variable">$terminalConfigTabBody</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">307</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">308</span></pre></td><td class="code"><pre><span class="line"><span class="comment"># 生成 template json 字符串</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">309</span></pre></td><td class="code"><pre><span class="line"><span class="variable">$templateBody</span> = (getTemplate <span class="variable">$templateVsersion</span> <span class="variable">$templateNodes</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">310</span></pre></td><td class="code"><pre><span class="line"><span class="comment"># 生成最终 json 文件</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">311</span></pre></td><td class="code"><pre><span class="line"><span class="variable">$templateBody</span> | <span class="built_in">Out-File</span> mbbconfig.json -Encoding utf8</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">312</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">313</span></pre></td><td class="code"><pre><span class="line">echo <span class="string">"Generator json template success"</span></span></pre></td></tr></table></figure>
</li>
<li><p><a href="https://www.pstips.net/xml-structure.html" target="_blank" rel="noopener">PowerShell处理XML（一）XML 结构</a></p>
</li>
</ul>
<h3 id="写文件"><a href="#写文件" class="headerlink" title="写文件"></a>写文件</h3><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">[System.IO.File]::WriteAllText(<span class="variable">$file</span>.FullName, <span class="variable">$result</span>, [System.Text.Encoding]::UTF8)</span></pre></td></tr></table></figure>

<h3 id="读写中文字体文件-不出现乱码"><a href="#读写中文字体文件-不出现乱码" class="headerlink" title="读写中文字体文件(不出现乱码)"></a>读写中文字体文件(不出现乱码)</h3><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">// string_zh_cn.h 文件是中文并且以 GB18030 编码保存</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"><span class="variable">$strFile</span> = <span class="string">'.\string_zh_cn.h'</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"><span class="variable">$content</span> = <span class="built_in">Get-Content</span> <span class="variable">$strFile</span> -Raw</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line"><span class="variable">$result</span> = <span class="variable">$content</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">foreach</span> (<span class="variable">$stringId</span> <span class="keyword">in</span> <span class="variable">$stringIDArray</span>) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">    <span class="variable">$result</span> = [regex]::Replace(<span class="variable">$result</span>, <span class="string">"&amp;<span class="variable">$stringId</span>"</span>, <span class="string">'(+++&#123;0&#125;-----)'</span> -f <span class="variable">$stringId</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="variable">$result</span> <span class="nomarkup">-ne</span> <span class="variable">$content</span>) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">    // 这里保存新文件时必须要以 UTF8 格式</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">    <span class="variable">$result</span> | <span class="built_in">Out-File</span> -FilePath <span class="variable">$strFile</span> -Encoding utf8</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<h3 id="去除文件重复语句"><a href="#去除文件重复语句" class="headerlink" title="去除文件重复语句"></a>去除文件重复语句</h3><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="variable">$sourceFile</span>=<span class="string">".\last_time_cn.md"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"><span class="variable">$newFile1</span>=<span class="string">".\unicque1.md"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"><span class="comment">#$newFile2=".\unicque2.md"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line"> </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line"><span class="comment"># Method one:</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">[System.Collections.Generic.HashSet[string]]<span class="variable">$lines</span> = <span class="built_in">Get-Content</span> -Path <span class="variable">$sourceFile</span> -ReadCount <span class="number">0</span> -Encoding UTF8</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line"><span class="built_in">Set-Content</span>  -Path <span class="variable">$newFile1</span> -Value (<span class="variable">$lines</span> -join <span class="string">"`r`n"</span>) -Encoding UTF8</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line"><span class="comment"># Method two:</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line"><span class="comment">#$ls = Get-Content -Path $sourceFile -ReadCount 0 | Select-Object -Unique</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line"><span class="comment">#Set-Content -Path $newFile2 -Value ($lines -join "`r`n")</span></span></pre></td></tr></table></figure>

<h3 id="正则表达式替换文件内容"><a href="#正则表达式替换文件内容" class="headerlink" title="正则表达式替换文件内容"></a>正则表达式替换文件内容</h3><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="variable">$content</span> = <span class="built_in">Get-Content</span> -LiteralPath <span class="variable">$file</span> -Raw</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"><span class="variable">$result</span> = [System.Text.RegularExpressions.Regex]::Replace(<span class="variable">$content</span>, <span class="string">'("[\d|A-Za-z| |!|\.|:|\[\]\(\)/_|\-&lt;&gt;=+#*\\n\u4e00-\u9fa5|\u3002\uff1b\uff0c\uff1a\u201c\u201d\uff08\uff09\u3001\uff1f\u300a\u300b]+")'</span>, &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">param</span>([System.Text.RegularExpressions.Match]<span class="variable">$match</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">        <span class="variable">$number</span> = <span class="variable">$match</span>[<span class="number">0</span>].Groups[<span class="number">1</span>].ToString()</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">        <span class="comment">#Write-Host $number</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">        <span class="built_in">write-output</span> <span class="variable">$number</span> | <span class="built_in">out-file</span> -filepath .\temp.txt -Encoding utf8 -Append</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">return</span> <span class="variable">$number</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">    &#125;)</span></pre></td></tr></table></figure>


<h3 id="提取中英文字幕"><a href="#提取中英文字幕" class="headerlink" title="提取中英文字幕"></a>提取中英文字幕</h3><p>下面是提取纸牌屋的字幕文件(去除字幕文件中的时间轴的其它字符)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (!(Test-Path dst)) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">    md dst | Out-Null</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">Get-ChildItem src\*.srt | ForEach-Object &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">    <span class="variable">$srcFile</span> = <span class="variable">$_</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">    Write-Output <span class="string">"Processing <span class="variable">$($srcFile.Name)</span>"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">    <span class="variable">$dstFile</span> = Join-Path <span class="string">'dst'</span> <span class="variable">$srcFile</span>.Name</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">    Get-Content <span class="variable">$srcFile</span> | ForEach-Object &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">        <span class="variable">$line</span> = <span class="variable">$_</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">if</span> (<span class="variable">$line</span> -cmatch <span class="string">'\A\d+\z'</span>) &#123; <span class="built_in">return</span> &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">if</span> (<span class="variable">$line</span> -cmatch <span class="string">'\d\d:\d\d:\d\d,\d\d\d --&gt; \d\d:\d\d:\d\d,\d\d\d'</span>) &#123; <span class="built_in">return</span> &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line">        <span class="variable">$line</span> = <span class="variable">$line</span> -creplace <span class="string">'\s*\&#123;\\.*?\&#125;\s*'</span>, <span class="string">''</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line">        <span class="built_in">echo</span> <span class="variable">$line</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line">    &#125; | Out-File <span class="variable">$dstFile</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">16</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<h3 id="提取电子书内容"><a href="#提取电子书内容" class="headerlink" title="提取电子书内容"></a>提取电子书内容</h3><p>下面是提取 《权力巅峰》 文本文件的 ps 处理代码。源文件是一个包含所有内容的 txt 文件，脚本会提取文件中的每个章节内容为一个独立的 md 文件，并自动生成 summary.md 目录文件。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="variable">$content</span> = Get-Content .\qldf.txt</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"><span class="comment"># 存储目录结构</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line"><span class="variable">$summary</span> = <span class="string">""</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line"><span class="comment"># 卷标题</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line"><span class="variable">$volume</span> = <span class="string">""</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line"><span class="comment"># 章标题</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line"><span class="variable">$chapterTitle</span> = <span class="string">""</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line"><span class="comment"># 章内容</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line"><span class="variable">$chapterContent</span> =<span class="string">""</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line"><span class="variable">$content</span> | ForEach-Object&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line">    <span class="variable">$line</span> = <span class="variable">$_</span>.ToString().Trim()</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line">    <span class="comment"># 滤掉空行</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line">    <span class="keyword">if</span>(<span class="variable">$line</span>.Length -gt 0)&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">16</span></pre></td><td class="code"><pre><span class="line">        </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">17</span></pre></td><td class="code"><pre><span class="line">        <span class="variable">$isVolume</span> = <span class="variable">$line</span> -match <span class="string">'^第[一二三四五六七八九十]+卷'</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">18</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">if</span>(<span class="variable">$isVolume</span>)&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">19</span></pre></td><td class="code"><pre><span class="line">            <span class="variable">$summary</span> += <span class="string">"* [<span class="variable">$line</span>]`r`n"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">20</span></pre></td><td class="code"><pre><span class="line">            <span class="comment">#"`r`n## $line" | Out-File -FilePath "$line.md" -Encoding utf8</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">21</span></pre></td><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">22</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">23</span></pre></td><td class="code"><pre><span class="line">        <span class="variable">$isTitle</span> = <span class="variable">$line</span> -match <span class="string">'^第[\d]+章'</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">24</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">if</span>(<span class="variable">$isTitle</span>)&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">25</span></pre></td><td class="code"><pre><span class="line">            <span class="comment"># 保存一个章节内容为一个文件</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">26</span></pre></td><td class="code"><pre><span class="line">            <span class="keyword">if</span>((<span class="variable">$chapterTitle</span>.Length -gt 0) -and (<span class="variable">$chapterContent</span>.Length -gt 0))&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">27</span></pre></td><td class="code"><pre><span class="line">                <span class="comment"># 文件名称使用 下划线 替换 空格</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">28</span></pre></td><td class="code"><pre><span class="line">                <span class="variable">$fileName</span> = <span class="variable">$chapterTitle</span>.Replace(<span class="string">' '</span>,<span class="string">'_'</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">29</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">30</span></pre></td><td class="code"><pre><span class="line">                <span class="variable">$summary</span> += <span class="string">"    * [<span class="variable">$chapterTitle</span>](<span class="variable">$fileName</span>.md)`r`n"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">31</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">32</span></pre></td><td class="code"><pre><span class="line">                <span class="string">"`r`n## <span class="variable">$chapterTitle</span> `r`n`r`n <span class="variable">$chapterContent</span>"</span> | Out-File -FilePath <span class="string">"<span class="variable">$fileName</span>.md"</span> -Encoding utf8</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">33</span></pre></td><td class="code"><pre><span class="line">            </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">34</span></pre></td><td class="code"><pre><span class="line">            &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">35</span></pre></td><td class="code"><pre><span class="line">            <span class="comment"># 清空,重新开始记录</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">36</span></pre></td><td class="code"><pre><span class="line">            <span class="variable">$chapterTitle</span> = <span class="string">""</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">37</span></pre></td><td class="code"><pre><span class="line">            <span class="variable">$chapterContent</span> =<span class="string">""</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">38</span></pre></td><td class="code"><pre><span class="line">            <span class="variable">$chapterTitle</span> = <span class="variable">$line</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">39</span></pre></td><td class="code"><pre><span class="line">        &#125;<span class="keyword">else</span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">40</span></pre></td><td class="code"><pre><span class="line">            <span class="variable">$chapterContent</span> += <span class="variable">$line</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">41</span></pre></td><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">42</span></pre></td><td class="code"><pre><span class="line">   &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">43</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">44</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">45</span></pre></td><td class="code"><pre><span class="line"><span class="string">"# Summary`r`n`r`n* [简介](README.md)`r`n`r`n<span class="variable">$summary</span>"</span> | Out-File -FilePath <span class="string">"summary.md"</span> -Encoding utf8</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">46</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">47</span></pre></td><td class="code"><pre><span class="line">Write-Host <span class="string">'Done'</span></span></pre></td></tr></table></figure>


<h3 id="知识点"><a href="#知识点" class="headerlink" title="知识点"></a>知识点</h3><ul>
<li><p>powershell 调用优先级: 别名 —&gt; 函数 -&gt; 命令 -&gt; 脚本(*.ps1) -&gt; 可执行文件</p>
</li>
<li><p>变量名不区分大小写</p>
</li>
<li><p>ps 所有的变量保存在 <code>variable</code> 驱动器中</p>
</li>
<li><p>显示环境变量: ls env:</p>
<figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">// 更新到系统环境变量中</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">PS&gt; [environment]::SetEnvironmentvariable(<span class="string">"Path"</span>, <span class="string">";c:\powershellscript"</span>, <span class="string">"User"</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">PS&gt; [environment]::GetEnvironmentvariable(<span class="string">"Path"</span>, <span class="string">"User"</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">;c:\powershellscript</span></pre></td></tr></table></figure></li>
<li><p>数组是固定大小,内部的内存是连续分布的，所以要添加新元素只能重新创建一个新的数组，添加使用 <code>$arr += xxx</code></p>
</li>
<li><p>去除数组中重复元素</p>
<figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="variable">$arr1</span> = <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"><span class="variable">$arr2</span> = <span class="variable">$arr1</span> | <span class="built_in">Get-Unique</span></span></pre></td></tr></table></figure></li>
<li><p>统计文件数据</p>
<figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">// 统计单词，行数，大小</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"><span class="built_in">Get-Content</span> .word.txt | measure -Line -Word -Character</span></pre></td></tr></table></figure></li>
<li><p>开启调试模式</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="variable">$DebugPreference</span>=<span class="string">"Continue"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">// wrte-debug 只有在调试模式下才会输出信息</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">write-debug <span class="string">'Hello'</span></span></pre></td></tr></table></figure>
</li>
<li><p>关闭调试模式</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="variable">$DebugPreference</span>=<span class="string">"SilentlyContinue"</span></span></pre></td></tr></table></figure>
</li>
<li><p>在函数避免错误信息作为返回值正确做法</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">Function ErrorTest()</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">    <span class="comment">#从这里开始隐藏所有的错误信息</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">    <span class="variable">$ErrorActionPreference</span>=<span class="string">"SilentlyContinue"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">    Stop-Process -Name <span class="string">"www.mossfly.com"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">    <span class="comment">#该进程不存在</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line"> </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">    <span class="comment">#恢复$ErrorActionPreference,错误开始输出</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">    <span class="variable">$ErrorActionPreference</span>=<span class="string">"Continue"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>
</li>
<li><p>定义多行文本</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">Here strings 定义多行文本</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">@<span class="string">"#独立一行</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"><span class="string">字符串”@格式定义多行文本，尤其是较长的文本，再好不过了</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line"><span class="string"></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line"><span class="string">这首诗用来评价陶渊明的诗歌再好不过了</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line"><span class="string"> </span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line"><span class="string">一语天然万古新，豪华落尽见真淳。</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line"><span class="string">南窗白日羲皇上，未害渊明是晋人。</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line"><span class="string">"</span>@<span class="comment">#独立一行</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">//这里要注意开始和结束的标记必须另起一行。</span></pre></td></tr></table></figure>
</li>
<li><p>生成全球唯一标识符</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="variable">$guid</span> = [GUID]::NewGUID()</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">    Foreach (<span class="variable">$format</span> <span class="keyword">in</span> <span class="string">"N"</span>,<span class="string">"D"</span>,<span class="string">"B"</span>,<span class="string">"P"</span>) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">    <span class="string">"GUID with <span class="variable">$format</span> : &#123;0&#125;"</span> -f <span class="variable">$GUID</span>.ToString(<span class="variable">$format</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">//GUID with N : e1a5d98f4227470b84c2b37a6a8fb894</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">//GUID with D : e1a5d98f-4227-470b-84c2-b37a6a8fb894</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">//GUID with B : &#123;e1a5d98f-4227-470b-84c2-b37a6a8fb894&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">//GUID with P : (e1a5d98f-4227-470b-84c2-b37a6a8fb894)</span></pre></td></tr></table></figure>
</li>
<li><p>移除 String 中 split 方法空元素</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="string">"https://www.pstips.net"</span>.split(<span class="string">":./"</span>,[StringSplitOptions]::RemoveEmptyEntries)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">http</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">www</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">pstips</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">net</span></pre></td></tr></table></figure>
</li>
<li><p>正则表达式中的 ignore,multiline 表示</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="string">"Abcdeafewe"</span> -match <span class="string">"(?i)abcd"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">// True</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"><span class="string">"Abcdeafewe"</span> -match <span class="string">"(?-i)abcd"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">// False</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line"><span class="variable">$text</span> = @<span class="string">"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line"><span class="string">这是一段文本，</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line"><span class="string">我想在回复的邮件中引用它，</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line"><span class="string">所以我在每行的开始追加了"</span>&gt;<span class="string">" 符号。</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line"><span class="string">"</span>@</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line"><span class="variable">$text</span> -replace <span class="string">"(?m)^"</span>, <span class="string">"&gt; "</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">&gt; 这是一段文本，</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line">&gt; 我想在回复的邮件中引用它，</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line">&gt; 所以我在每行的开始追加了<span class="string">"&gt;"</span> 符号。</span></pre></td></tr></table></figure>
</li>
<li><p>换行符号使用 `(数字 1 左边)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">[regex]::Replace(<span class="variable">$text</span>, <span class="string">"\A"</span>, <span class="string">"&gt; "</span>, `</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">[Text.RegularExpressions.RegExOptions]::Multiline)</span></pre></td></tr></table></figure>
</li>
<li><p>条件操作符</p>
<figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="nomarkup">-eq</span> ：等于</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"><span class="nomarkup">-ne</span> ：不等于</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"><span class="nomarkup">-gt</span> ：大于</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line"><span class="nomarkup">-ge</span> ：大于等于</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line"><span class="nomarkup">-lt</span> ：小于</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line"><span class="nomarkup">-le</span> ：小于等于</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line"><span class="nomarkup">-contains</span> ：包含</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line"><span class="nomarkup">-notcontains</span> :不包含</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">-and ：和</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">-or ：或</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">-xor ：异或</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line"><span class="nomarkup">-not</span> ：逆</span></pre></td></tr></table></figure></li>
</ul>
	  

		<!-- 微信公众号关注 logo -->
		<div class="text-center">
			<img src="http://jessechiu.synology.me:5959/images/2020/11/13/wechat-subscribe.jpg">
			<span class="text-danger">全栈开发者微信公众号</span>
		</div>

	</div>

	<div>
  	<center>
	<div class="pagination">
<ul class="pagination">
	 
				
    	<li class="prev"><a href="/2018/12/03/2018-12-03-mermaid/" class="alignleft prev"><i class="fa fa-arrow-circle-o-left"></i>Prev</a></li>
  		

        <li><a href="/archives"><i class="fa fa-archive"></i>Archive</a></li>

		
		   <li class="next"><a href="/2018/11/16/2018-11-16-gitbook-start/" class="alignright next">Next<i class="fa fa-arrow-circle-o-right"></i></a></li>         
        
	
</ul>
</div>

    </center>
	</div>

  <!-- share -->
  

	</div> 
		
	
	<div id="side_meta">
		<div class="col-md-3" id="post_meta"> 

	<!-- date -->
	
	<div class="meta-widget">
	<i class="fa fa-clock-o"></i>
	2018-12-03 
	</div>
	

	<!-- categories -->
    
	<div class="meta-widget">
	<a data-toggle="collapse" data-target="#categorys"><i class="fa fa-folder"></i></a>	
    <ul id="categorys" class="tag_box list-unstyled collapse in">
          
  <li>
    <li><a href="/categories/Powershell/">Powershell<span>1</span></a></li>
  </li>

    </ul>
	</div>
	

	<!-- tags -->
		

	<!-- toc -->
	<div class="meta-widget">
	
	</div>
	
  <hr>

<!-- 淘宝广告 -->

	<div id="myCarousel" class="carousel slide" data-ride="carousel">

		<!-- 轮播（Carousel）指标 -->
		<ol class="carousel-indicators">
			

				
					<li data-target="#myCarousel" data-slide-to="0" class="active"></li>
				

			
		</ol>   

		<!-- 轮播（Carousel）项目 -->
		<div class="carousel-inner">
			

				
					<div class="item active">
						<a href="https://item.taobao.com/item.htm?spm=a2oq0.12575281.0.0.25911debHjpm1G&ft=t&id=573820740653" title="汽车用增高坐垫司机女士座垫主驾驶员单座矮个子加高加厚座椅" target="blank">
							<img src="https://gd3.alicdn.com/imgextra/i4/76548092/TB22E6hF_JYBeNjy1zeXXahzVXa_!!76548092.jpg_400x400.jpg" alt="驾考增高坐垫" class="nofancybox">
							<div class="carousel-caption">驾考增高坐垫</div>
						</a>
					</div>	
				

			
		</div>

  </div> 


</div><!-- col-md-3 -->

	</div>
		

</div><!-- row -->


	</div>
  </div>

  <div class="container-narrow">
  <footer> 
<!-- 不蒜子统计 -->

    <span id="busuanzi_container_site_pv">
            本站总访问量 <span id="busuanzi_value_site_pv"></span> 次
    </span>
    <span class="post-meta-divider">|</span>
    <span id="busuanzi_container_site_uv" style='display:none'>
            本站访客数 <span id="busuanzi_value_site_uv"> </span>人
    </span>
    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>


<span>
  &copy; 2020 JesseChiu
  
</span>

<span>
      with help from <a href="http://hexo.io/" target="_blank">Hexo</a> and <a href="http://getbootstrap.com/" target="_blank">Twitter Bootstrap</a>. Theme by <a href="http://github.com/wzpan/hexo-theme-freemind/" target="_blank" rel="noopener">Freemind</a>.    
</span>
 </footer>
</div> <!-- container-narrow -->

  


  
<a id="gotop" href="#">   
  <span>▲</span> 
</a>

<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>
<script src="/js/search.js"></script> 


<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>



   <script type="text/javascript">      
     var search_path = "search.xml";
	 if (search_path.length == 0) {
	 	search_path = "search.xml";
	 }
	 var path = "/" + search_path;
     searchFunc(path, 'local-search-input', 'local-search-result');
   </script>

  
</body>

   </html>
